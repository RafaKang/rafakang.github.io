{"nodes":[{"block_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","block_type":1,"children":["StSxdchG7oPOhrxpaAJcszjdnPh","Aa4KdbN2uowlsuxras6cEhpLn5d","ZwNYdxLBKo4YkuxkFuDc6vnMnQg","Oflfd77nOofRYIxHjuKceRUNnKb","GQPldffEfom6O7xCwZycmbWXn7g","LrcLdLY5QoFuAzxgOAUcEXxun4g","JSd0dQFQho0zURxCVUdczTVDnhc","Vn8jdY5SXolAnwx5PE5cphninSg","KcC9dArb1orgxixVLXBcxkJDngG","VMcIdTQNjo9CjNx54xqcHAhcnkd","KpC2d7hYroSr6KxkpyScovGcnJc","VMomdYSA1ox0qHxNzYeckPS2nUt","PrQOdsE4pohM9kxDHlfcB8henYb","AGhwdZte6oCtVpx83cEcZVoLnGg","R91ndrPeHoYCSDxGWnAcV7hCnYi","QgJGdQCcWoATrhxb2fwcoWO5nJd","SMJ6dlMZAomPmQxJRDUcJnu3nVe","XmT5d8eUtooT2Qx1BwucDvZ2nPf","IMf3dhljGoS1W9x7y2BctfO3nnA","YUvJdliHbo5RtcxdSM9cp66rnSh","Kj6WdkFnPoKjrzxV117caKynnQf","RzsVdCbrroXarIxD1ZScJxDDnkb","KeArdEy8yoN3sZxv8kFcdaAinub","Tgy3dT8vhoe34yxmV9NcyK9SnKH","MPw0dYY4HohJtYxjhjkceiLonXb","ME5jdpk0joC4MXx8sbZcqABJnMg","HVwEdwWXFoHMmVx88Kychvoynih","Wa4jd0iZooftpmxTifWcK02Unjh","FJ2cdlHoMogBG0x0iihcYhGqn4c","HA6NdySqLomXbhxXT3gcKM1Bnre","Pi7tdG8QUo812ZxtnU2c0lnsnLc","NlGwd3BEhonlNRxzEl1c5Ta4nsb","J63EdMAaXo8WDGxd0f2cWLsRnKg","GAy3dMCSxo5dbuxQfFrc2ASgn6b","INHwdQz1HoZO4ExMBOtcfg4LnJh","PuDddUmZTon7cxxwVzIcuznjnfc","JdfodcaP3o6iyCx1KaFcUdCan3c","TvWZdyrODoenVcxKPcUcMs5tnvd","HK3cdRVLvolLOQxbbqLcx8E3nde","NhX2d2dWCopKcjxCYpwcn7AwnXg","JabxdPHb0oOp6XxPhXvcu4kXnOb","V0i7dJOsYoby7PxhwrYcFUahnGc","AmoTdzrkMon6k7xw9Fmc7LCKnwc","WIcCdG73qojWUGxJgRTc1gQDnce","QxSldEwuYoTKXKxdrBWcBqCFnig","GtOvdp4C4oH2JDxurp7cnbBdnph","P1n1d1YcDo1CUKxBfyxcz4ylnRB","Bli2dfKWHo6kCmxVGMTcYQ59nxg","DxhddG0pSobOFkxQOPFc7CS0ntd","Ka5CdODBloNagbxot2UcbrQ1nph","WgIAdUaa2oYdERxYXUmcCY38nKA","LkQhd9sx5oQpawx30STcxYBgnKh","Ad7PdVHYuonPvLxN6mocNDCKnst","X5ODdFWToo1IaZxzAe3crkTGnfc","Krl5dJ2YMoVe2uxwjjRcf3yxnac","Ez7cd6MXuoJ3AVxUQppcWqTwn7f","Zyf0dI7cooNMvhx3WNtcgmD6n3f","JB81dEMQ2oVVXAxCNwwclfFxnyP","AgQjdoWPAosROgx8ztNchPJYn4e","IWwZdLkwDoWyzix5MNvcInmPn2g","CUuad9X2joKXn0xG93pcsop0nQg","OokAdtBDuoy5Spxe0cOc34vvnFe","VuGYdDv0ooVLKYxen6vcVA0rnjg","NJM1dfwx7ouhPKxld8icbRRznl0","UgYBd0QTdo232NxS65NcJ2DFnLd","GdYkdqXPEony7YxOvsbcL6mjnge","C6dCdOt0loMi1RxxwvfcnNsEnrd","WhVsdQfQwoCV7WxH8KIcXthgnTb","MIEwdBVd0o5k3sxu0hVcO4wcnqd","VgqPdchR8oP4UlxMobVcOAF8nbc","JtsAd4ZeBoIcaExBMkbcmVuen8c","IzRnd6rgBoS2bwxkpiuc0ZY0nib","Qw7xdaMQ8oyx3Fxx9Lkc3yfXnDe","F16bdgGfzoGgnFxtC1ncfTlgnJg","DNBedKvM4olcbcxqLZecg9LTnLb","Va0pd3gIHoYOtEx6itdcnmUCnmg","Cx31dTR8Co0qhMxFqlDczBovnqd","Ic0od86BYo2sj8xstVNcE2FQnTg","ZH7ddITmzoAIBqx9GoscFWjPnJd","Od5vd4MaYogzRpxDkTfcGYUCnZf","Xkp4dEOcyohWszxmjMjcShNsnHf","IX2jdX43qo0hs7xhKAkc7qyFnVb","TcEedxLgio9Jvgxf4PUcKGucn5f","QAdndMIa7orPYCx21q2cxTWjnCg","KWU2daA0voOWOixSrDNciqdynxd","FWufdCKNlowM2UxXSpFcoXFznrd","QU4zdPQfVokdOpx83HrcoctUn0b","BI1qdiRK2obV4IxgeUxcy6njn3d","St1pdQoQIoGNpDxZNvhcbh6tnhh","Ufh2dSUejo3QPwxYmM0crxAdnwc","DJV5dkupCoa9OixxDlOcafjsn6b","KD3PdzF4Jojsbrx59IicJ9UNnLh","N9FAdSOujo8Bi5xskACcUp9gnng","J6PvdUuoEoSHVfxCdRwculcenAb","DIODdE1KqoWvZ9xlgH9cYHgwn5c","ZUDad1NLMo0Y4xxhFhScwryInU9","UQBGdeRXZomIOLxhBGvcmv5cntf","RGkAdR5lGouajextKoScfNcdnKf","OWIsdwOrsoXozfxo1hGcvdQ4nng","SHpYdju6Qoq6nlxRYEccDb34n1e","KnK1ddluqo8jpQxM7JYcFZDvndn","Xko7db3RRoLmt5x1p8Mc77Nonjf","TOZZdO98Qoe02Txb4lUcWQrsnig","Kx1idPxG4obVBcxAS0JcMpq5nPu","Jrsdd3s77oo4LgxPlIacEfqCnAf","PvC2deB5iogqIpx081jcaqibnZb","AOnkdhFA8oiPtYxabwbcKq2fnqd","QjgLdQFZ7owld4xpFBYcg9Qanmd","HwMjdSvs3oksz3xn0J0cZ6LgnNb","Zl9cd5dG8owP0BxpqK3cYoxUnzL","J1rJd7mqMooPnPxJp91cKeCjnbd","M2xbdjbXLomUgMxgWXRcQzkBnqe","KfXDdu4OSoz1mkx1rBac7AROnvc","HKf7d7NKyopEMmxlMFsckUGDnWe","GnNDdIQTcom7nJxo8Sscugkbnzg","D6MqdiXnioSxpMxJhEpcdvdpnrf","OyUYdYft8oWQvkxWriscZUOTnsg","I2CpdLPZloSbw7xmZmicbiminvf","Ujlld3RFbo4vQfx9nrScsKN6nTh","DoKMd6YsGoNFz0xT7qHcjWMMnac","N6xfd74RUoFjtLxlzuIcEsNrntg","UBhrdvOfEoZQWsxYnS3cWCEPn2c","WfERdpn7NoDW7HxV8dIcUOQmngb","EhErdJyzdogUVlxV6ADcZoo8nuh","AoUkdWHMvoA3JIxReOIcVSWlnSh","QpVddrFIsoRNoqxt8jTcbkzCnlf","MK19dXRm0o8NBjxLOoycKQ2MnVf","ZbdmduekfoHJgBxeGxJcdZeEnzh","HEyrdx0tmoj9IVxFLlBcaLZInSc","R52pd6AKBozExkx33NjckKzUnof","WGYbdyeRyoS7FBxJ1N6ckP1cnNg","Yicsdi40coXqeYxwnoJcWTbWnke","WwMIdMRnsovHQ4xyIPecRoPpndb","TNnZdewxjokBpPxa2GvcFPkJnmT","QAyydYCRhocfKRxMjbhcuTqnn2f","YG6sdtXUdoX07vxdCVwczm98nZd","IMUodcYmvovXTRxdbyPcpRI4n4f","RoE3dXrlWoVWRDxAA2dcQnEGnEd","IeqhdvQtAoF2otxVGDWcUVJnnRx","WLQhdEUUOoqI66xj3psc2Iuon7Q","Co2EdWsUaoB7v2xf4wEcoEQbnld","YJUvdxQ8ooaKDdx7354cgsizneb","GGvCds14foIMvCxpMBLc39vPnnf","I6Hnd5nHvoYt37x4a0XcnkPanmd","Qb0Hd6tMQoCriRx7vPYcYXzKnie","Qg8jd5WpCo4q8xxv9DocLkJqnHW","KtKMdrbdCozR7ExvELFcHJ0mnnc","AR8ddCXAgoOIG2xVrUbcUw5Vnae","SjwwdIAY2oXH4txv3Dbcz3RVnFc","DJ9Kd2Cb3oIj9pxhUIgcyVcDnEe","C4m7dzthCoQvkmxn1XgcN9Qangb","GcP6d4BeGoTuybxFIECcGtf4nIZ","KKhTd5z0coYFYHx236gcDXtvnxu","PAuJdzUVCoLjAhx9g0xcYChYn0e","Kg4zdstSnoAV3DxSWitckeBynda","Lqs4dbjnJolZGaxyRRLcfnB2nye","FpQkddlA2oYRjNxKPjfc5imOn8b","C4OMdRbcZoc5Kex5O1ec7eyYnmb","U9ZfdQbTQoMZFcx3lcvcc6irnUf","CnXrd7UuboBIylxU7EAcG9PIn1c","RMRodUbrqoNqVvxNJjnciKzln1e","TIbdd2LZXoseBAx5QEAcwSRanpL","IRa2diqwsosKPTxDYjXc1Z3YnDc","Wipxdo13NoOA4BxeRfCcZleQnSc","UnUDdWrXioVciyxJ1WgcOM89ngc","RjWZdvMHioSK2wxEyVmcT9Kpn2b","EYyrduEPbosi0hxyWjFczM63njd","BavEdvuG0oW4L3xK0ovclpPXnAh","GcUKdpOpQo0DtPxXATvcSt1tnwe","HKSVdAkvUo3jzNxBnPJcdhKJn2f","PwnddETqNoTxQpxKmxXc0pURnrd","UGWedIQTjoEQ8KxupDPc0gElnod","B5yydPUZ8o2M1bxTJ2acv7PFnKJ","L2o0dQOG5ov27Xx47tmc5mmVnAg","DbV1d8cDooY47JxBqlFcu9vWnmi","ER8vdbaN0oHbzCxf25Ycggf4nvB","TxkLd0Ln6ob8duxkAJjcSBKZn0g","FUGAdFiuVoEsPWxZ088cFRrEnhb","GQvzdA31HoiH5XxbmeecZrDXnSb","P4KidY0wmoRVCCxK5lycz1jOnzI","V05RdmoBToY679xzxrqcc6KZn3c","CfF2dV2VVoHrTnxVkUwcJg0Lnrd","EDfydSDStoQ3RHxspS5cf4n3nfe","YVeVdlatjo1XvgxjxCdcPpEGnIb","Re5fdF9f0oBntrxWMq4cVZ7qnbc","TSRtd7pX2o4pOJxZYMOcZW84ngG","HJCsdrdD6owJlMxiUGHcnUPonzd","JxERdllp0o8Tc6xnPeuc1LYonJd","KGBXdoq8XoJn0UxM1b8cWtbcnDb","RpcfdQeElohEiaxbl1UcZItwndT","CVUfdVRXco0b2Rx0VLrc5YiZnid","Hp3pdSDmEoAUejxE5k6c6HdUnUe","DsqUd2mZxoSH8jxOE07cDLxPnJg","K6yFdyTQoo3Sx8xMLJzcFEUvnDc","Ki6kdg1GDoSExwxDlvBcbATjnjg","GJ6IdhnzxorMiqxVbtxcIyhnnWe","Mw8rdZM6PoUVlZx1Y3bcMVA8nbd","HkkPdU4ZtoX0FsxbOXyc1Vh0n8b","Vsx0d5P7toHtMZxjq23cL2Kanuf","Wnvyd9cK0oq5ifxvkikcq0zAn9c","SN6EdM0aOol5IIxMoT3cM8pZnTg","KsRedpkxcoPmEyxWkvXcW4ZwnZe","MLEidDL2joBj5sxyNx6cYg9GnYf","MILIdH2hcoQcilxzcbAcfkTQnxd","Q5fNdsYZuomIRnxgrNUchbKdnId","J3fId0YhAoisQyxFyRCclTbhnKd","XuatdrWLJoA5m1xvuiKcqPpNn7c","Pv8udeDvloiK9WxXyTncH4agnlb","VDfpdFTYeowCpGxM7D1c4B8FnOf","KPlNdkwxzocwFWxtOFUcOlbinzg","Iq5tdPPhwoHOCqx7xpjcJ7FTn1g","Dct9d0XlkoZ8CZxqyFxcy7yNnqg","GIBKdfnEXoyhSnxbxgFcCK6lnkQ","C0xSdzv7roB6FEx1d15cIZSpnBd","RBH5dMcjlolRdGxaCsjcOLGun6c","Fo1dd98ehoSCJFxB9zzc9J54nWg","NNZod0fG2olqN7xwbVIcKebjnxc","Ev4odSxZCoyzmexZvlUcNdTCnHf","RUZSdHyxDo7n5DxRVZjcq6rPnle","G4bvdl01uoOKZTxAYt3cvGRBnug","MSivdrH7bokKsExkVfacZt6gnge","Lr6PdP0l5o3Lj3xwHcTc9DYbngc","AYccdAR4CoEnmpxV3JecXGOJnXg","Rq4zdjPGwo0dE4xiEd1ciquYnQc","BBbndWrbyoFxNExbV3lctx0qnye","VdqIdlk9Ao3UfTxWtyNcIjSvnQe","HU6Nd2GnZoHLnuxXmaIcx8cTnog","A4BNdSUgSozzJXxrf6Sczhoonyf","KF3RdnULSoLuzvxPrimcfu0FnIf","XKi8dl5ZkomfaAx4xs0cj42Qn8f","Th7ydOvQioha3jxvEgXcUspKnRY","LqWndVwBco63DcxQVKGcXRCtnNg","EW7IdE6JaoA0F8xi9IpcTW7Ence","ToGUdIWh7oYmUxx8cA5cG9UCn0W","HEB1dTa3soXa9pxdnbUcqrCGnGe","THx8dsVr0ohsBwxH3FNcelKenvf","DYoedluDNoPykuxUO1ocZAQDntf","Am26dXjJPoEuidxAtn4cOFNHn3e","U51JdVoUkomuQ8xS6S7cI3W0nL8","FDHHdqQ5HokP7yxehdfc3mG0nWf","W3OGdFIJ3oRF26xyxUHcaBgQnYC","JgFxdWzxrowKhKxXUWrcLE8znkf","R3QHd6qGAovqIhxelZocTI4ynBd","YIM1d3MqboBhtJxes2GceuvznOd","TVEyd5CgqoucDBxQ9w2c7gNMnah","RAc6dtzHnoZgn7xgyKgc0qpFnAg","JASkdbfQooyL5qxLd7QcdIeon2f","D4TzdusUEoy4a0xSLXNcZnKonxd","G1iNdmsM6oFxeAxryYgclxmgn6d","RkWPd8AOhoF2ISxJGvBc2gOtnBh","QvZPdbnJzoX9QBxvyGrcDU1snhg","WRpidRqLNoJ7Gkx1Ww2c1Pc1nSb","PvskdQtKTo7bNuxJSODcXcLEntg","HCIadvyosomd8BxppOqc4VNGnyb","JYFSdIP6womhS6x5zXyccWGznYc","QedNdZF42ooZj0xouwfcBTMhnJh","CkfFdKGiFohw92xvuHVciRConRl","LahndkeGzoyNPZxibaHcoj6kn9k","BAKVduYjvoIfiVxpMDqckx37n6d","D63ldLDFIoihWWxHxwbcVM3Lngf","PZpGd8Cj6o9U2DxQXa1cFeIYncd","WRoXdMMhkowsg8xS9vpcJX2XnNg","Vjxzd710Bo4VuExExJFcICT1neh","CeYEdkmNvoSCWNx7Y9McizNTnZe","Sw4tdRasJoC8O2xk4rkcQEI1nmb","Eewwds2Pbow6fxxe9CmcTYmznQb","CtvId635qox4RHx87FocTe6EnHd","RJhddupMAoKjhkxhyiTc7JVOnCG","IbildNYDxo24LwxtK02cjIBynbj","Cn2udHIBbofO4fxqxB7cUu5ynde","NiaYdZWmboBEtzxENTnceTccnfe","LvCQdJMeEod2RjxGFaqcAvU6nuh","IFwjdaOXDoHHl7xt1cVcjld9nSb","W1Wkd3uF2ofh92xNBmZcHzQzn3e","OaW8duNVxoHfIPx8QKncyAmznXg","GInndbHS2o0RZlxhgZFcjwkXnVc","SuJfdTwTEo2KeZx9uk0cr3s9nMb","UqVGdgw8XoYNkuxmFAdcwrxCngR","CpN6dhQKPowgXXxRpMgcK1SAnZb","G8FDdhApZodtyTxFMCzc4NeOnEg","IZCRdG8oCo2WAnx1e2mcHjsmnqb","NHbIdVANWoPhD0xVR6hcPXP5nJc","WWGFdtMcroIdxIx7YZ8cicVSnGh","QmWidbW3ioRKgCxVekQc2hkin5c","F9Q5dRQCvoC6unxYMiRcEOjHnLc","VAgjdzw9Qomid1xBEIOciL8mnsg","IpL8dOiaLovav0xjiIjcngJNnUd","Q4nCd29sYouKUIxHwadcKh0YnXf","EiutdWeuSoQ3G3xBw7Lcayynneb","PFOzdXDuboSehyxn460cTynGnLh","P8mYdjTGaoedUTxooANchGWhn8d","VRSydNy6FozPLYxHyojc7KhpnSh","QizwdhZh5oddMGxYcBQcoY8bnue","X2NFdnGT0ok2POxyrHmcOPDwnWe","SCnodoaOJo7jA4x8CxYcMaTynAe","MXdvdgbn5oWrbQxpDjTcKV19ntc","Vg68d0sBQoA0h1xQwhBcpyxOnXf","ZONOdwYC4oV77DxaQ9rcLCLZncc","AEQUdytM4oeb1uxQs0AcXW0jnXb","RbYBdXGvmo9DgMxwoNgce6BsnIe","Evz6dCj1doOz6mxtloWcOFcznMy","REYtdgZtvoNvNlxxCEyclwyVnvg","Agn9dQftAor2e4xJzajccvuvnXf","DFRbdAPAXoWXb5xKLxmcRRdVndw","Yqbvdo6Krox844xXWADcTVErnUc","XX1ZdATTYoZAstxO8PhcXLJInEe","NTSOdZTJ9oViPuxv5jfc0CIZnch","VAmtdIo4oouumfx0rgFcYFFLnah","DCXmd0wuOopoQFx8TEsc2uhInxh","L1v1dUNEGoZnaXxi5RucN6OJnCf","Ow2Md6Hxood5wvxQhYUctwcMnCb","C5ESdzBmsonkFjxHD1GcDd16n8g","AFSKdeAHpooSMnxf4zqcw4fInqg","WfOEdvHCao8OTwxbPSfcCEYhnBb","X0QkdcpPwoY6QAxX3wMcpYCYnse","C8Sqd7e8Io145axjE3dc4sDYnPf","WbCOdQNkBo8k6xxBxApcyP2wnGe","KPeedFD8moMlE9xRhCacFRUhnNe","I9Qzd4c1Vo6bijxt9Z1cNWiunbh","U4HVd2xoloEqGaxxZ0vce5K7nNA","AOQnd9dRQoZbioxzQLzcnXNhnJg","EuR7de7tsoYmF5xauTic4lq1n1b","FZW2d4i1RoEZ1BxSNoMcVRqFnBd","VDi7dbxoSo3F0Lxf2TKcG0MgnFf"],"page":{"elements":[{"text_run":{"content":"Atcoder泛做","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1}},"parent_id":""},{"block_id":"StSxdchG7oPOhrxpaAJcszjdnPh","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC178D.Delete Range Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc178%2Ftasks%2Farc178_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Aa4KdbN2uowlsuxras6cEhpLn5d","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的排列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，每次选一个区间，然后把区间","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"从这个排列中移除。问有多少排列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"能通过以上操作最终得到一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZwNYdxLBKo4YkuxkFuDc6vnMnQg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"M\\leq N\\leq500\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Oflfd77nOofRYIxHjuKceRUNnKb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GQPldffEfom6O7xCwZycmbWXn7g","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"计数题，应该先找计数对象的特征。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LrcLdLY5QoFuAzxgOAUcEXxun4g","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先拿","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"序列和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[1,N]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"做一个差，就能得到每次移除的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这些","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"一定从大到小移除的。因为如果反之，当我取更大","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的时候会发现少了一个数而取不到。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JSd0dQFQho0zURxCVUdczTVDnhc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"选择一个原序列中的区间然后删除Mex的话，首先这个Mex一定不在区间中，并且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[0, Mex-1]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中的所有数都一定出现在这个区间里。那么假设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[0,Mex-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这些数在原序列中的区间是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"一定在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的外面。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vn8jdY5SXolAnwx5PE5cphninSg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接下来是对于我来说比较容易忽略的点——每次移除操作不改变元素的相对位置，这样","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"序列就是原序列的一个子序列。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KcC9dArb1orgxixVLXBcxkJDngG","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么计数对象","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的特征大概就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VMcIdTQNjo9CjNx54xqcHAhcnkd","block_type":13,"ordered":{"elements":[{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的子序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"KpC2d7hYroSr6KxkpyScovGcnJc","block_type":13,"ordered":{"elements":[{"text_run":{"content":"一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"必然在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[0,Mex-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"形成的区间之外","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"VMomdYSA1ox0qHxNzYeckPS2nUt","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"考虑到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的位置由","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[0,Mex-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"确定，那么从小到大向序列中加数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PrQOdsE4pohM9kxDHlfcB8henYb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"因为性质1，所有这里加数只能在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"序列的空隙中加，一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个空位。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AGhwdZte6oCtVpx83cEcZVoLnGg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"考虑性质2，当添加一个新数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的时候，我们还需要知道","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[0,i-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的区间是多大，这样才能确定","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的可选位置。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"R91ndrPeHoYCSDxGWnAcV7hCnYi","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以可以写出如下DP。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QgJGdQCcWoATrhxb2fwcoWO5nJd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[i][l][r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个数，目前占据了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这些空位的序列方案数。当","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的时候，考虑枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的位置，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"可选的位置大概是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"l","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之前包括","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"l","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之后包括","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的所有空位。当","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"不是一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的时候，最开始就卡在这里，实际上假设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的位置是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"pos[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么枚举前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的空位","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，跟当前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"pos[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"做一个并即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SMJ6dlMZAomPmQxJRDUcJnu3nVe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"具体实现上DP的状态发生了一些变化。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"XmT5d8eUtooT2Qx1BwucDvZ2nPf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[i][l][r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示如果下一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，当前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"不可用的方案数。最终输出的结果是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[N][2][M]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，因为最左边和最右边的空位永远都可以用，且整个序列的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mex","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。由性质2，在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"空位插入一个数，相当于屏蔽了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"空位或","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"空位；如果是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"序列中的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"位置，相当于屏蔽了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"空位或","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"空位。转移大差不差。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IMf3dhljGoS1W9x7y2BctfO3nnA","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" N, M;\n    read(N, M);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> a(M + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= M; ++i)\n        read(a[i]);\n\n    std::vector<std::vector<std::vector<modint>>> dp(N + 1, std::vector(M + 3, std::vector<modint>(M + 3)));\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> pos(N, 0);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= M; ++i)\n        pos[a[i]] = i;\n    if (!pos[0])\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= M + 1; ++i)\n            dp[1][i + 1][i - 1] = 1;\n    }\n    else\n        dp[1][pos[0] + 1][pos[0]] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i < N; ++i)\n    {\n        if (!pos[i])\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l = 2; l <= M + 2; ++l)\n            {\n                modint sum = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= M + 1; ++j)\n                {\n                    dp[i + 1][l][j - 1] += sum + dp[i][l][j - 1];\n                    sum += dp[i][l][j - 1];\n                }\n            }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r = 0; r <= M; ++r)\n            {\n                modint sum = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = M + 1; j >= 1; --j)\n                {\n                    dp[i + 1][j + 1][r] += sum + dp[i][j + 1][r];\n                    sum += dp[i][j + 1][r];\n                }\n            }\n        }\n        else\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l = 2; l <= M + 2; ++l)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r = 0; r <= M; ++r)\n                    dp[i + 1][std::min(pos[i] + 1, l)][std::max(pos[i], r)] += dp[i][l][r];\n        }\n\n        // for (int l = 2; l <= M + 2; ++l)\n        //     for (int r = 0; r <= M; ++r)\n        //         printf(\"dp[%d][%d][%d] = %d\\n\", i + 1, l, r, dp[i + 1][l][r]);\n    }\n    printf(\"%d\\n\", dp[N][2][M]);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"YUvJdliHbo5RtcxdSM9cp66rnSh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：方向是对的，先根据题意找计数对象的特征。而且基本上分析差不多了，但是卡在枚举到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"序列本身那个地方。实现的时候，这种维数比较多的转移写起来要非常非常小心且专心，每个决策对应的转移都要想得非常清楚，debug的时候要有耐心，手算即便很困难也不能弃疗。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Kj6WdkFnPoKjrzxV117caKynnQf","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC349G.Max (Sum - Max)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc348%2Ftasks%2Fabc348_g"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"RzsVdCbrroXarIxD1ZScJxDDnkb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有两个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。给出一个长度","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，选出","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个下标组成集合","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，求","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i \\in S}A[i] - max_{i \\in S}B[i]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。对于每个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，求这样的值","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KeArdEy8yoN3sZxv8kFcdaAinub","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Tgy3dT8vhoe34yxmV9NcyK9SnKH","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设就一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，按","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"排序，显然就是一个经典数据结构问题。选一个最好的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，使得","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之前的前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"大+","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]-B[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"最大。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MPw0dYY4HohJtYxjhjkceiLonXb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"但是现在很多个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，就得琢磨一下了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ME5jdpk0joC4MXx8sbZcqABJnMg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一般来说这种都会有一个性质，比如单调性。对于某一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，最好的是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，决策点不会小于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HVwEdwWXFoHMmVx88Kychvoynih","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"可以打表也可以证一下。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Wa4jd0iZooftpmxTifWcK02Unjh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F_{i}(k)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个数前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"大的和。对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j < i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F_{j-1}(k-1)+A[j]-B[j] < F_{i-1}(k-1)+A[i]-B[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FJ2cdlHoMogBG0x0iihcYhGqn4c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"如果对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，决策点是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F_{j}(k)+A[j]-B[j]>F_{i}(k)+A[i]-B[i]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a_{i}[k]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个数第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"大的数。那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F_{j-1}(k-1)+a_{j}[k]+A[j]-B[j]>F_{i}(k)+a_{i}[k]+A[i]-B[i]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。由于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i>j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"那么显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a_{j}[k] \\leq a_{i}[k]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，所以就矛盾了。那么可以知道决策一定是单调的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HA6NdySqLomXbhxXT3gcKM1Bnre","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"利用类似DP单调性优化二分队列的思想，用一个栈维护决策以及对应区间，最终求解即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Pi7tdG8QUo812ZxtnU2c0lnsnLc","block_type":14,"code":{"elements":[{"text_run":{"content":"#pragma GCC optimize(\"Ofast\")\n#pragma GCC optimize(\"inline\", \"fast-math\", \"unroll-loops\", \"no-stack-protector\")\n#include <bits/stdc++.h>\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using ll = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using uint = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"unsigned","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using ull = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"unsigned","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n\n#define lowbit(x) (x & (-x))\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"const ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mod = 998244353;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"const ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"double","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" PI = 3.14159265358;\nstd::mt19937 rng(std::random_device{}());\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"namespace","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" FI\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" B[1 << 16], *S = B, *T = B;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" getc()\n    {\n        return S == T && (T = (S = B) + fread(B, 1, 1 << 16, stdin), S == T) ? EOF : *S++;\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" read()\n    {\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"template","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" <","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"typename","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Tp, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"typename","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"... Types>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" read(Tp &o, Types &...Args)\n    {\n        o = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" c = getc();\n        while (c > '9' || c < '0')\n            s |= c == '-', c = getc();\n        while (c >= '0' && c <= '9')\n            o = o * 10 + c - '0', c = getc();\n        if (s)\n            o = -o;\n        read(Args...);\n    }\n} // namespace FI\nusing FI::read;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"constexpr ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" MultiTestCases = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"constexpr ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" MAXN = 2e5;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Info\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v;\n    ll sum = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" size = 0;\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Merge\n{\n    Info operator()(const Info &lhs, const Info &rhs) const\n    {\n        Info res;\n        res.sum = lhs.sum + rhs.sum;\n        res.size = lhs.size + rhs.size;\n        res.v = rhs.v;\n        return res;\n    }\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" PersistentSegmentTree\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    const ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    const Merge merge;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" node\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2> ch{};\n        Info info;\n    };\n    std::array<node, MAXN * 20 + 5> tree;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cnt = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    PersistentSegmentTree(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" _n) : n(_n), merge(Merge())\n    {\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pull(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ls = tree[p].ch[0], rs = tree[p].ch[1];\n        tree[p].info = merge(tree[ls].info, tree[rs].info);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" modify(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x, const Info &v)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" q = ++cnt;\n        tree[q] = tree[p];\n        if (l == r)\n            return tree[q].info = merge(tree[p].info, v), q;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [ls, rs] = tree[p].ch;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1;\n        if (x <= mid)\n            tree[q].ch[0] = modify(ls, l, mid, x, v);\n        else\n            tree[q].ch[1] = modify(rs, mid + 1, r, x, v);\n        return pull(q), q;\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" modify(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" root, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p, const Info &v)\n    {\n        return modify(root, 1, n, p, v);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    Info query(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" y)\n    {\n        if (p == 0)\n            return Info{};\n        if (l == x && r == y)\n            return tree[p].info;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [ls, rs] = tree[p].ch;\n        if (y <= mid)\n            return query(ls, l, mid, x, y);\n        else if (x > mid)\n            return query(rs, mid + 1, r, x, y);\n        else\n            return merge(query(ls, l, mid, x, mid), query(rs, mid + 1, r, mid + 1, y));\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    Info query(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" root, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r)\n    {\n        if (l > r)\n            return Info{};\n        return query(root, 1, n, l, r);\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    Info right_most(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k)\n    {\n        if (k == 0)\n            return {};\n        if (l == r)\n            return {tree[p].info.v, 1ll * tree[p].info.v * k, k};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [ls, rs] = tree[p].ch;\n        if (tree[rs].info.size <= k)\n            return merge(right_most(ls, l, mid, k - tree[rs].info.size), tree[rs].info);\n        else\n            return right_most(rs, mid + 1, r, k);\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    Info right_most(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" root, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k)\n    {\n        return right_most(root, 1, n, k);\n    }\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ll> A[MAXN + 5];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" roots[MAXN + 5];\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Node\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i, l, r;\n};\nNode stack[MAXN + 5];\nll ans[MAXN + 5];\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" N;\n    read(N);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        read(A[i].first, A[i].second);\n    std::sort(A + 1, A + N + 1,\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"              [&](const std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ll> &lhs, const std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ll> &rhs)\n              {\n                  return lhs.second < rhs.second;\n              });\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::set<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> set;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::map<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> mp;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        set.insert(A[i].first);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cnt = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : set)\n        mp[v] = ++cnt;\n\n    static PersistentSegmentTree segment_tree(cnt);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        roots[i] = segment_tree.modify(roots[i - 1], mp[A[i].first], {A[i].first, A[i].first, 1});\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cmp = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k) -> ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n    {\n        ll left = segment_tree.right_most(roots[j - 1], k - 1).sum + A[j].first - A[j].second;\n        ll right = segment_tree.right_most(roots[i - 1], k - 1).sum + A[i].first - A[i].second;\n        return left > right;\n    };\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" top = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n    {\n        while (top && !cmp(stack[top].i, i, stack[top].l))\n            top--;\n        if (top)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [j, l, r] = stack[top];\n            while (l <= r)\n            {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1;\n                if (cmp(j, i, mid))\n                    l = mid + 1;\n                else\n                    r = mid - 1;\n            }\n            stack[top].r = r;\n            stack[++top] = {i, l, i};\n        }\n        else\n            stack[++top] = {i, 1, i};\n    }\n\n    while (top)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [i, l, r] = stack[top];\n        top--;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = l; k <= r; ++k)\n        {\n            Info res = segment_tree.right_most(roots[i - 1], k - 1);\n            ans[k] = res.sum + A[i].first - A[i].second;\n        }\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        printf(\"%lld\\n\", ans[i]);\n\n    return 0;\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" TestCases = 1;\n    if constexpr (MultiTestCases == 1)\n        scanf(\"%d\", &TestCases);\n\n    while (TestCases--)\n        Main();\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"NlGwd3BEhonlNRxzEl1c5Ta4nsb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"由于求解的内容没有前后依赖，可以使用更好写的决策单调性分治；并且由于决策点暴力转移时间复杂度不会更高的特性，可以避免使用可持久化线段树这样常数大的数据结构，实测下来真的差好多。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"J63EdMAaXo8WDGxd0f2cWLsRnKg","block_type":14,"code":{"elements":[{"text_run":{"content":"#pragma GCC optimize(\"Ofast\")\n#pragma GCC optimize(\"inline\", \"fast-math\", \"unroll-loops\", \"no-stack-protector\")\n#include <bits/stdc++.h>\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using ll = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using uint = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"unsigned","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"using ull = ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"unsigned","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"long","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":";\n\n#define lowbit(x) (x & (-x))\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"const ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mod = 998244353;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"const ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"double","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" PI = 3.14159265358;\nstd::mt19937 rng(std::random_device{}());\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"namespace","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" FI\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" B[1 << 16], *S = B, *T = B;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" getc()\n    {\n        return S == T && (T = (S = B) + fread(B, 1, 1 << 16, stdin), S == T) ? EOF : *S++;\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" read()\n    {\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"template","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" <","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"typename","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Tp, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"typename","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"... Types>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" read(Tp &o, Types &...Args)\n    {\n        o = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" c = getc();\n        while (c > '9' || c < '0')\n            s |= c == '-', c = getc();\n        while (c >= '0' && c <= '9')\n            o = o * 10 + c - '0', c = getc();\n        if (s)\n            o = -o;\n        read(Args...);\n    }\n} // namespace FI\nusing FI::read;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"constexpr ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" MultiTestCases = 0;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"template","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" <","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"class","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" T, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"typename","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Merge = std::plus<T>>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" FenwickTree\n{\n    std::vector<T> fwt;\n    const Merge merge{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n\n#ifndef lowbit\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    inline ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" lowbit(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x) const\n    {\n        return (x & (-x));\n    }\n#endif\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    FenwickTree(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" _n) : n(_n), fwt(_n + 1)\n    {\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" modify(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pos, T delta)\n    {\n        if (pos == 0)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            return fwt[0] = merge(fwt[0], delta), ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = pos; i <= n; i += lowbit(i))\n            fwt[i] = merge(fwt[i], delta);\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    T query(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pos) const\n    {\n        T res{};\n        if (pos < 0)\n            return res;\n        pos = std::min(pos, n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = pos; i; i -= lowbit(i))\n            res = merge(res, fwt[i]);\n        res = merge(res, fwt[0]);\n        return res;\n    }\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Info\n{\n    ll sum = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" size = 0;\n};\n\nInfo operator+(const Info &lhs, const Info &rhs)\n{\n    return {lhs.sum + rhs.sum, lhs.size + rhs.size};\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    read(n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<ll, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> a(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(a[i].second, a[i].first);\n\n    std::sort(a.begin() + 1, a.end());\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> tab(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        tab[i] = {a[i].second, i};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::sort(tab.begin() + 1, tab.end(), std::greater<std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">>{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> p(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        p[tab[i].second] = i;\n    FenwickTree<Info> fwt(n);\n\n    static constexpr ll INF = 1e18;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cur = 0;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" f = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k)\n    {\n        if (i < k)\n            return -INF;\n        while (cur < i)\n        {\n            cur++;\n            fwt.modify(p[cur], {a[cur].second, 1});\n        }\n        while (cur > i)\n        {\n            fwt.modify(p[cur], {-a[cur].second, -1});\n            cur--;\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l = 1, r = n;\n        fwt.modify(p[i], {-a[i].second, -1});\n        while (l <= r)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [_, size] = fwt.query(mid);\n            if (size > k - 1)\n                r = mid - 1;\n            else\n                l = mid + 1;\n        }\n        ll res = fwt.query(r).sum + a[i].second - a[i].first;\n        fwt.modify(p[i], {a[i].second, 1});\n        return res;\n    };\n\n    std::vector<ll> ans(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> cnt(n + 1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":")> solve = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" dl, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" dr)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = (l + r) >> 1, best = dl;\n        ll mx = -INF;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = dl; i <= dr; ++i)\n        {\n            if (ll tmp = f(i, mid); tmp > mx)\n                mx = tmp, best = i;\n        }\n        // printf(\"%d %d\\n\", mid, best);\n        ans[mid] = mx;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = dl; i <= dr; ++i)\n            if (cnt[p[i]])\n                fwt.modify(p[i], {-a[i].second, -1}), cnt[p[i]]--;\n\n        if (l < mid)\n            solve(l, mid - 1, dl, best);\n        if (r > mid)\n            solve(mid + 1, r, best, dr);\n    };\n\n    solve(1, n, 1, n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        printf(\"%lld\\n\", ans[i]);\n\n    return 0;\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" TestCases = 1;\n    if constexpr (MultiTestCases == 1)\n        scanf(\"%d\", &TestCases);\n\n    while (TestCases--)\n        Main();\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"GAy3dMCSxo5dbuxQfFrc2ASgn6b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：对于单个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，是典题；如果是多个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"需要考虑特殊性质，一般来说都是一些单调性；在这道题里能隐隐约约感觉到这个单调性的存在，如果不想证明就直接打表；在有限的时间内（ABC只有100分钟）凭直觉猜结论这种能力还是很重要的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"INHwdQz1HoZO4ExMBOtcfg4LnJh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"决策单调性，二分队列是很常规的做法，基本上可以应对绝大部分的情况，然而一般来说这种算法的常数都比较大。在这里的体现是，比较两个决策点的优劣时旧决策点维护的数据结构要保留，所以只能使用可持久化数据结构，空间和时间常数都很大。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PuDddUmZTon7cxxwVzIcuznjnfc","block_type":27,"image":{"align":2,"height":223,"token":"VHDIbrlMRobLiwx4iIFcQK2TnTc","width":2404},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"JdfodcaP3o6iyCx1KaFcUdCan3c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"单调性分治的做法是对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"直接暴力求一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mid","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，得到子区间的决策上下界，再求","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,mid-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[mid+1,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。如果是这种","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i] = dp[j]+w(j,i)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的式子，在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[l..mid-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"求解之前无法确定","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[mid]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的值，单调性分治就会失效，所以经常见于分层的动态规划。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TvWZdyrODoenVcxKPcUcMs5tnvd","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC326G.Unlock Achievement","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc326%2Ftasks%2Fabc326_g"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"HK3cdRVLvolLOQxbbqLcx8E3nde","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个技能，M个成就。技能升级需要花费，最高升五级。一个成就需要某些技能达到某些等级，获得某些回报。求最大的回报-花费是多少","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NhX2d2dWCopKcjxCYpwcn7AwnXg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JabxdPHb0oOp6XxPhXvcu4kXnOb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一句话：最大权闭合子图...","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"V0i7dJOsYoby7PxhwrYcFUahnGc","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/maxflow>\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> c(n + 1), a(m + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(c[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        read(a[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" sum = std::accumulate(a.begin(), a.end(), 0);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector l(m + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(n + 1));\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= n; ++j)\n            read(l[i][j]);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    atcoder::mf_graph<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> graph(m + n * 5 + 2);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 0, t = m + n * 5 + 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 2; k <= 5; ++k)\n            graph.add_edge(m + (i - 1) * 5 + k, t, c[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 2; k <= 5; ++k)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            graph.add_edge(m + (i - 1) * 5 + k, m + (i - 1) * 5 + k - 1, std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::max());\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n    {\n        graph.add_edge(s, i, a[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= n; ++j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            graph.add_edge(i, m + (j - 1) * 5 + l[i][j], std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::max());\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cut = graph.flow(s, t);\n    std::cout << sum - cut << std::endl;\n\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"AmoTdzrkMon6k7xw9Fmc7LCKnwc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：读题就建出模了，很典...","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WIcCdG73qojWUGxJgRTc1gQDnce","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC335G.Discrete Logarithm Problems","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc335%2Ftasks%2Fabc335_g"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"QxSldEwuYoTKXKxdrBWcBqCFnig","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"给出一个数组","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和质数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，找出数对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(i,j)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"满足：存在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"使得","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{i}^k \\equiv A_{j} \\mod P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N\\leq 2 \\times 10^5, P\\leq 10^{13}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GtOvdp4C4oH2JDxurp7cnbBdnph","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"P1n1d1YcDo1CUKxBfyxcz4ylnRB","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"题目明示离散对数问题，考虑原根。一个奇素数必然存在原根，这个原根是模","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"运算的生成元，设这个原根是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[1,P-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中每个数，都是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的某次幂，且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g,g^2,...,g^{P-1}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是不同的数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Bli2dfKWHo6kCmxVGMTcYQ59nxg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接下来考虑阶的定义。一个数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a=g^q\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的阶","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，指的是最小的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"使得","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a^m \\equiv 1\\mod P\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。注意到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g^{q*m} \\equiv 1 \\mod P\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的阶。那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"q*m\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的倍数，且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是最小的，这样","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"q*m\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"lcm(q,P-1)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m=\\frac{gcd(P-1,q)}{d}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DxhddG0pSobOFkxQOPFc7CS0ntd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"引入原根之后，可以把","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"写成","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g^{q_i}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是就变成","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g^{q_i*k}\\equiv g^{q_j}\\mod P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。由于幂运算肯定有一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的环，那么相当于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"q_i*k\\equiv q_{j} \\mod (P-1)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这个方程有解的前提是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"q_j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"gcd(q_i, P-1)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的倍数。等价于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"gcd(q_j, P-1)|gcd(q_i, P-1)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d[i] = gcd(q_i, P-1)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，统计","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d[i]|d[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的个数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ka5CdODBloNagbxot2UcbrQ1nph","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"由于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"10^{13}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"内的数最多有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"11000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个左右的约数，所以暴力遍历是可行的，总次数大概是5e7的级别。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WgIAdUaa2oYdERxYXUmcCY38nKA","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"问题变成怎么求","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。朴素的想法肯定是找到原根","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，然后挨个求幂次。第一想法是BSGS，而实际上BSGS算法的复杂度太高会TLE。其实这里我们只想要","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。所以用找到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的阶就能找到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LkQhd9sx5oQpawx30STcxYBgnKh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以问题变成了怎么求阶。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a^{P-1}\\equiv 1 \\mod P\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，然后","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"肯定是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的约数且是满足条件最小的那个。可以考虑把","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"质因数分解，一个一个质因数往下除，直到幂次不为1。一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(log_{2}(P-1))\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个质因数，每次求快速幂都有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(log_{2}P)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的复杂度，因此总复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(Nlog_{2}^2P)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ad7PdVHYuonPvLxN6mocNDCKnst","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"X5ODdFWToo1IaZxzAe3crkTGnfc","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    ll p;\n    read(n, p);\n    std::vector<ll> a(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(a[i]);\n    if (p == 2)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" z0 = 0, z1 = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n            z0 += (a[i] % 2) == 0, z1 += (a[i] % 2);\n        std::cout << 1ll * z0 * z0 + 1ll * z1 * z1 << std::endl;\n        return 0;\n    }\n\n    std::vector<ll> order(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> prime;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    static constexpr ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" MX = 3.2e6;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    static std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", MX> mnp{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 2; 1ll * i * i <= p; ++i)\n    {\n        if (!mnp[i])\n            mnp[i] = i, prime.push_back(i);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pr : prime)\n        {\n            if (1ll * pr * i * i * pr > p)\n                break;\n            mnp[i * pr] = pr;\n            if (i % pr == 0)\n                break;\n        }\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pow = [&](ll x, ll q) -> ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"ll","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n    {\n        if (q == 0)\n            return 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"__uint128_t","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ans = 1, base = x;\n        while (q)\n        {\n            if (q & 1)\n                ans = ans * base % p;\n            q >>= 1;\n            base = base * base % p;\n        }\n        return ans % p;\n    };\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<ll, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> pfactors;\n    ll q = p - 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pr : prime)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" size = 0;\n        while (q % pr == 0)\n        {\n            size++;\n            q /= pr;\n        }\n        if (size)\n            pfactors.emplace_back(pr, size);\n    }\n    if (q != 1)\n        pfactors.emplace_back(q, 1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n        order[i] = p - 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [pr, size] : pfactors)\n        {\n            while (size--)\n            {\n                if (pow(a[i], order[i] / pr) == 1)\n                    order[i] /= pr;\n                else\n                    break;\n            }\n        }\n    }\n\n    std::vector<ll> d(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        d[i] = (p - 1) / order[i];\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::map<ll, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> mp;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        mp[d[i]]++;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<ll, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> buc;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [gcd, size] : mp)\n        buc.emplace_back(gcd, size);\n\n    ll ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < buc.size(); ++i)\n    {\n        ans += 1ll * buc[i].second * buc[i].second;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = i + 1; j < buc.size(); ++j)\n            if (buc[j].first % buc[i].first == 0)\n                ans += 1ll * buc[i].second * buc[j].second;\n    }\n    std::cout << ans << std::endl;\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Krl5dJ2YMoVe2uxwjjRcf3yxnac","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：涉及很多离散对数、原根和阶的基础知识和引理。从引入原根开始，思路是很自然的，前提是懂知识点，是一道很好的例题。ABC果然很Educational。感觉还应该记一下各数量级的超级合数的东西，快速推定约数个数的最大值，方便计算复杂度。OEIS链接是这个：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"https://oeis.org/search?q=1344+maximal+divisors","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。然后Codeforces的讨论中提到可以使用","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N^{\\frac{1}{3}})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"来估算。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ez7cd6MXuoJ3AVxUQppcWqTwn7f","block_type":27,"image":{"align":2,"height":218,"token":"ZQxgbVwU1ouDZsx65OecZhRindb","width":1387},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Zyf0dI7cooNMvhx3WNtcgmD6n3f","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC179D.Portable Gate","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc179%2Ftasks%2Farc179_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"JB81dEMQ2oVVXAxCNwwclfFxnyP","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一棵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的树，有一个棋子和传送门，任意节点开始遍历整棵树。有三种操作：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AgQjdoWPAosROgx8ztNchPJYn4e","block_type":13,"ordered":{"elements":[{"text_run":{"content":"沿一条边移动棋子，花费为1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"IWwZdLkwDoWyzix5MNvcInmPn2g","block_type":13,"ordered":{"elements":[{"text_run":{"content":"将棋子移动到传送门处，没有花费","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"CUuad9X2joKXn0xG93pcsop0nQg","block_type":13,"ordered":{"elements":[{"text_run":{"content":"将传送门移动到棋子处，没有花费","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"OokAdtBDuoy5Spxe0cOc34vvnFe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"问最少的遍历花费是多少","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VuGYdDv0ooVLKYxen6vcVA0rnjg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N \\leq 2 \\times 10^5","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NJM1dfwx7ouhPKxld8icbRRznl0","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UgYBd0QTdo232NxS65NcJ2DFnLd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个重要的分析是，先移动棋子，然后移动传送门，等价于棋子和传送门同时沿一条边移动，花费为1。然后假设棋子最终停在某一个节点上，将棋子移动回传送门，同样不增加花费。这样初始状态和终止状态，棋子和传送门都在相同的位置。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GdYkdqXPEony7YxOvsbcL6mjnge","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样我们要考虑的就是从哪一个节点开始走、到哪一个节点停止。假设没有传送门，显然问题的答案是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2*(N-1)-d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"其中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是直径。如果考虑传送门，那么需要考虑传送门是否跟着棋子一起走，如果跟着走，是否还会回到原位置。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"C6dCdOt0loMi1RxxwvfcnNsEnrd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"可以考虑如下树形DP。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WhVsdQfQwoCV7WxH8KIcXthgnTb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[v][0]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示当前子树没有传送门从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"开始的遍历花费，显然是经典问题，维护最大深度和子树大小即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MIEwdBVd0o5k3sxu0hVcO4wcnqd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[v][1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示当前子树棋子和传送门都在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，且终点不在该子树中的遍历花费。对于每一个子树，考虑传送门是否跟着走，如果跟着走，走一条边的花费是2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VgqPdchR8oP4UlxMobVcOAF8nbc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[v][2]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示当前子树棋子和传送门都在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，且终点在该子树中的遍历花费。考虑在当前根节点处终止，花费就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[v][1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，否则找一个子树终止，其它子树按传送门跟着走和不跟着走的决策讨论。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JtsAd4ZeBoIcaExBMkbcmVuen8c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样解决了从1节点开始的遍历问题，考虑从任意节点开始的遍历问题，显然换根DP即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IzRnd6rgBoS2bwxkpiuc0ZY0nib","block_type":14,"code":{"elements":[{"text_run":{"content":"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    read(n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector adj(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1, u, v; i <= n - 1; ++i)\n    {\n        read(u, v);\n        adj[u].push_back(v), adj[v].push_back(u);\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> size(n + 1), dep(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2>> mxdep(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3>> dp(n + 1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":")> DP = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" fa) -> ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n    {\n        size[u]++;\n        dep[u] = dep[fa] + 1;\n        mxdep[u][0] = dep[u];\n        if (fa != 0)\n            adj[u].erase(std::find(adj[u].begin(), adj[u].end(), fa));\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            DP(v, u);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n        {\n            size[u] += size[v];\n            if (mxdep[v][0] > mxdep[u][0])\n            {\n                mxdep[u][1] = mxdep[u][0];\n                mxdep[u][0] = mxdep[v][0];\n            }\n            else\n                mxdep[u][1] = std::max(mxdep[u][1], mxdep[v][0]);\n        }\n        dp[u][0] = 2 * (size[u] - 1) - (mxdep[u][0] - dep[u]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" tmp = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            tmp += std::min(dp[v][0] + 1, dp[v][1] + 2);\n\n        dp[u][2] = dp[u][1] = tmp;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            dp[u][2] = std::min(dp[u][2], tmp - std::min(dp[v][0] + 1, dp[v][1] + 2) + dp[v][2] + 1);\n        // printf(\"dp[%d] = {%d, %d, %d}\\n\", u, dp[u][0], dp[u][1], dp[u][2]);\n    };\n    DP(1, 0);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ans = std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::max();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3>)> reroot = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" dist, std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> from)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" tmp = 0;\n        ans = std::min({ans, dp[u][1] + std::min(from[0] + 1, from[1] + 2), dp[u][1] + from[2] + 1, dp[u][2] + std::min(from[0] + 1, from[1] + 2)});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2>> pre(adj[u].size() + 1), suf(adj[u].size() + 2);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= adj[u].size(); ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = adj[u][i - 1];\n            pre[i][0] = pre[i - 1][0] + std::min(dp[v][0] + 1, dp[v][1] + 2);\n            pre[i][1] = std::min(pre[i - 1][0] + dp[v][2] + 1, pre[i - 1][1] + std::min(dp[v][0] + 1, dp[v][1] + 2));\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = adj[u].size(); i >= 1; --i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = adj[u][i - 1];\n            suf[i][0] = suf[i + 1][0] + std::min(dp[v][0] + 1, dp[v][1] + 2);\n            suf[i][1] = std::min(suf[i + 1][0] + dp[v][2] + 1, suf[i + 1][1] + std::min(dp[v][0] + 1, dp[v][1] + 2));\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= adj[u].size(); ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = adj[u][i - 1];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> f{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mxd = (mxdep[v][0] == mxdep[u][0]) ? mxdep[u][1] : mxdep[u][0];\n            mxd -= dep[u];\n            mxd = std::max(dist, mxd);\n            f[0] = 2 * (n - size[v] - 1) - mxd;\n            f[1] = std::min(from[0] + 1, from[1] + 2) + suf[i + 1][0] + pre[i - 1][0];\n            f[2] = std::min({f[1], from[2] + 1 + suf[i + 1][0] + pre[i - 1][0], std::min(from[0] + 1, from[1] + 2) + suf[i + 1][1] + pre[i - 1][0], std::min(from[0] + 1, from[1] + 2) + suf[i + 1][0] + pre[i - 1][1]});\n            reroot(v, mxd + 1, f);\n        }\n    };\n    reroot(1, 0, {-1, -2, -1});\n    std::cout << ans << std::endl;\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Qw7xdaMQ8oyx3Fxx9Lkc3yfXnDe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：最重要的一步是合并操作3和操作1，这样传送门的决策就变少了，对于原题的分析就简化了。回传送门的操作没有额外花费，化简了终止状态。这样整个问题剩下的思路就很自然，从子树DP到换根DP都是经典问题。所以问题的解决要挖掘性质，方便分析或者程序处理。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"F16bdgGfzoGgnFxtC1ncfTlgnJg","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC332G.Not Too Many Balls","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc332%2Ftasks%2Fabc332_g"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"DNBedKvM4olcbcxqLZecg9LTnLb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种球，每种球有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个盒子，每种盒子有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的容量。第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种球在第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个盒子里最多放","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i \\times j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个。问最多能放多少个球。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Va0pd3gIHoYOtEx6itdcnmUCnmg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N \\leq 500, M \\leq 5 \\times 10^5","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Cx31dTR8Co0qhMxFqlDczBovnqd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ic0od86BYo2sj8xstVNcE2FQnTg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"好好好，好题。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZH7ddITmzoAIBqx9GoscFWjPnJd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先是个很显然的最大流的模型。但是二分图每两个点之间都有边，边数超多。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Od5vd4MaYogzRpxDkTfcGYUCnZf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"然后是重点转化过程——从最大流转化到最小割。然后有三种边要割，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的边，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的边，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"T","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的边。由于是最小割，所以一旦割了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S->A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的边，就不用考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"往后的边。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Xkp4dEOcyohWszxmjMjcShNsnHf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设枚举割掉的源点相连的边集","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"U","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，剩余集合是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"V","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"有两种决策，要么对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"V","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"都割掉，要么割掉","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。发现前者对应的是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"V","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中节点标号之和与","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的乘积，显然对于不同的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"V","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"只要节点标号之和相同，对应的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的决策肯定相同。不妨直接枚举节点标号之和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"sum","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IX2jdX43qo0hs7xhKAkc7qyFnVb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样需要计算的变成了两个部分——对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，节点标号之和为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N*(N+1)/2-sum","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"时的最小","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之和——显然是个背包；对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，选择","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"min(B[j],sum*j)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，按顺序枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"sum","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之后就是个单调性问题。两者独立，然后加和求最小。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TcEedxLgio9Jvgxf4PUcKGucn5f","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n    std::vector<ll> a(n + 1), b(m + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(a[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        read(b[i]);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" w = n * (n + 1) / 2;\n    std::vector dp(2, std::vector<ll>(w + 1, std::numeric_limits<ll>::max()));\n    dp[0][0] = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j <= w; ++j)\n        {\n            if (dp[0][j] != std::numeric_limits<ll>::max())\n                dp[1][j] = std::min(dp[0][j], dp[1][j]);\n            if (j >= i && dp[0][j - i] != std::numeric_limits<ll>::max())\n                dp[1][j] = std::min(dp[0][j - i] + a[i], dp[1][j]);\n        }\n        std::swap(dp[1], dp[0]);\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<ll, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> c(m + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        c[i] = {b[i], i};\n    std::sort(c.begin() + 1, c.end(),\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"              [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r)\n              {\n                  return l.first * r.second > r.first * l.second;\n              });\n    std::vector<std::array<ll, 2>> sum(m + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        sum[i][0] = sum[i - 1][0] + c[i].first, sum[i][1] = sum[i - 1][1] + c[i].second;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ll ans = std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"decltype","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(ans)>::max();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = w, p = 1; s >= 0; --s)\n    {\n        if (dp[0][w - s] == std::numeric_limits<ll>::max())\n            continue;\n        while (p <= m && c[p].first > 1ll * c[p].second * s)\n            p++;\n        ans = std::min(ans, dp[0][w - s] + sum[p - 1][1] * s + sum[m][0] - sum[p - 1][0]);\n    }\n    std::cout << ans << std::endl;\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"QAdndMIa7orPYCx21q2cxTWjnCg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：这个最小割的转化太惊人了。我是没想到的。但是是有端倪的，从本质上说这是一个完全二分图而且点权是一个简单的式子，应该会存在简单的做法。其实转化到最小割之后整个思路就很自然了，从复杂的集合枚举到找到集合最有用的特征，然后归约到已知问题，这是一个常见的CP题目分析法。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KWU2daA0voOWOixSrDNciqdynxd","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC173D.Bracket Walk","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc173%2Ftasks%2Farc173_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"FWufdCKNlowM2UxXSpFcoXFznrd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"在一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条边的单向强连通图中，每条边要么是(要么是)。判定是否存在一个经过了所有边至少一次，且遍历顺序是一个合法的括号序列的环。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N \\leq 4000, M\\leq8000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QU4zdPQfVokdOpx83HrcoctUn0b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"BI1qdiRK2obV4IxgeUxcy6njn3d","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先这个环不一定非得是合法的括号序列，只要正反括号数量相等即可。设正反括号权值分别为1和-1，只要找到最小的负数前缀和，从这个点开始走，就是一个合法的括号序列了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"St1pdQoQIoGNpDxZNvhcbh6tnhh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所有要找的是一个权值为0的环。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ufh2dSUejo3QPwxYmM0crxAdnwc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"因为图强联通，所有必然存在一个环经过了所有边。假设这个环的权值是正数，相当于我们要拿一些负数去找补成0。只要存在一个负数环，就可以找补成0。因为组成正数权值和负数权值的LCM，加起来就是0了。对于这个环权值是负数也是一样的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DJV5dkupCoa9OixxDlOcafjsn6b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以问题变成，是否存在正数环以及负数环；如果都存在或都不存在，答案是Yes；否则答案是No，因为永远找补不回0。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KD3PdzF4Jojsbrx59IicJ9UNnLh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"搜环是Spfa的一个子应用，套用即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"N9FAdSOujo8Bi5xskACcUp9gnng","block_type":14,"code":{"elements":[{"text_run":{"content":"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    scanf(\"%d%d\", &n, &m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector adj(n + 1, std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2>>{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, v;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"char","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" c[2];\n        scanf(\"%d%d%s\", &u, &v, c);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" w = (c[0] == '(') ? 1 : -1;\n        adj[u].push_back({v, w});\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" BellmanFord = [&]() -> ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> dist(n + 1), cnt(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> vis(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::queue<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> q;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n            q.push(i), vis[i] = true;\n        while (!q.empty())\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u = q.front();\n            vis[u] = false;\n            cnt[u]++;\n            if (cnt[u] > n)\n                return true;\n            q.pop();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [v, w] : adj[u])\n            {\n                if (dist[v] < dist[u] + w)\n                {\n\n                    dist[v] = dist[u] + w;\n                    if (!vis[v])\n                        q.push(v), vis[v] = true;\n                }\n            }\n        }\n        return false;\n    };\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" neg = BellmanFord();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &[_, w] : adj[i])\n            w = -w;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pos = BellmanFord();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" res = neg ^ pos ^ 1;\n    if (res)\n        printf(\"Yes\\n\");\n    else\n        printf(\"No\\n\");\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"J6PvdUuoEoSHVfxCdRwculcenAb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：有点抽象的推理题。解法有点像局部搜索，假设有一个解，然后用这个解去靠近最优解，然后分析性质才能得到解的充要条件。CP题需要很多假设以及简单的暴力，要有抽象思考问题的能力。能不着眼于具体的case，眼光着眼于整个问题才能得到优秀的解法。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DIODdE1KqoWvZ9xlgH9cYHgwn5c","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC176D.Swap Permutation","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc176%2Ftasks%2Farc176_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"ZUDad1NLMo0Y4xxhFhScwryInU9","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"给出一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的排列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，每次操作任选两个不相等的下标","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，交换","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。求所有可能的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次操作后，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i=1}^{N-1}|P[i]-P[i+1]|","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"值。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UQBGdeRXZomIOLxhBGvcmv5cntf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RGkAdR5lGouajextKoScfNcdnKf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"只能说是学到新东西了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"OWIsdwOrsoXozfxo1hGcvdQ4nng","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"l=min(P[i],P[i+1]),r=max(P[i],P[i+1])","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，一对间隔的计算相当于数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"l<k\\leq r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的数量。假设枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，找到每个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"能提供贡献的位置和数量就可以计算总贡献。据说这个叫切糕模型，来源于一个网络流题目","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SHpYdju6Qoq6nlxRYEccDb34n1e","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"[HNOI2013] 切糕","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fwww.luogu.com.cn%2Fproblem%2FP3227"},"strikethrough":false,"text_color":7,"underline":false}}},{"text_run":{"content":"，会去补一下。考虑把原序列转化为01串","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s[i]=P[i]\\geq k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么显然在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"串中01和10的出现会提供贡献。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KnK1ddluqo8jpQxM7JYcFZDvndn","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接下来是一个神奇的东西。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Xko7db3RRoLmt5x1p8Mc77Nonjf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"因为每次交换是等概率选取一对数而且每次操作独立，所以每个状态到新状态的选法是一样的。很新奇的思路。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TOZZdO98Qoe02Txb4lUcWQrsnig","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设原串中一个00，意味着","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[i]<k,P[i+1]<k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，变成同样是00的位置，方案有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Kx1idPxG4obVBcxAS0JcMpq5nPu","block_type":13,"ordered":{"elements":[{"text_run":{"content":"选一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i,i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之外的小于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的数，一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k-3","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个，跟","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"交换，一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2(k-3)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种选法；","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"1"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Jrsdd3s77oo4LgxPlIacEfqCnAf","block_type":13,"ordered":{"elements":[{"text_run":{"content":"交换","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i,i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，显然只有一种","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"PvC2deB5iogqIpx081jcaqibnZb","block_type":13,"ordered":{"elements":[{"text_run":{"content":"交换除了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i,i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"之外的两个数，一共是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"C_{n-2}^{2}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种选法","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"sequence":"auto"}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"AOnkdhFA8oiPtYxabwbcKq2fnqd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以最终能写出一个矩阵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mat\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QjgLdQFZ7owld4xpFBYcg9Qanmd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"Mat=\\begin{bmatrix}\nC_{n-2}^{2}+2(k-3)+1&n-k+1&n-k+1&0\\\\\nk-2&C_{n-2}^{2}+n-2&1&n-k\\\\\nk-2&1&C_{n-2}^{2}+n-2&n-k\\\\\n0&k-1&k-1&C_{n-2}^{2}+2(n-k-1)+1\n\\end{bmatrix}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么经过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次操作，状态的变换就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mat^m\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HwMjdSvs3oksz3xn0J0cZ6LgnNb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接下来只需要枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，统计原序列中00,01,10,11的出现数做成一个向量","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。经过矩阵的变换，求解变换之后的方案数，对总答案贡献即可。看起来是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N^2*4^3*log_{2}M)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，实际上每次枚举到一个新的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，只需要关注","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p[i]=k-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"前后的两个位置，去更新","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"即可。复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N*4^3*log_{2}M)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Zl9cd5dG8owP0BxpqK3cYoxUnzL","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/modint>\nusing modint = atcoder::modint998244353;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Matrix\n{\n    std::array<std::array<modint, 4>, 4> a{};\n\n    Matrix operator*(const Matrix &rhs) const\n    {\n        Matrix res{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < 4; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < 4; ++j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 0; k < 4; ++k)\n                    res.a[i][j] += a[i][k] * rhs.a[k][j];\n        return res;\n    }\n};\n\nMatrix quick_pw(Matrix a, ll b)\n{\n    static Matrix I{std::array<std::array<modint, 4>, 4>{std::array<modint, 4>{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}};\n    if (b == 0)\n        return I;\n    Matrix ans = I, base = a;\n    while (b)\n    {\n        if (b & 1)\n            ans = ans * base;\n        b >>= 1;\n        base = base * base;\n    }\n    return ans;\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> p(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(p[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> pos(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        pos[p[i]] = i;\n\n    std::array<modint, 4> v{0, 0, 0, n - 1};\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 2; k <= n; ++k)\n    {\n        Matrix mat{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pre = pos[k - 1] - 1; pre)\n        {\n            if (p[pre] >= k)\n                v[3] -= 1, v[2] += 1;\n            else\n                v[1] -= 1, v[0] += 1;\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" suf = pos[k - 1] + 1; suf <= n)\n        {\n            if (p[suf] >= k)\n                v[3] -= 1, v[1] += 1;\n            else\n                v[0] += 1, v[2] -= 1;\n        }\n        mat.a[0][0] = 1ll * (n - 3) * (n - 2) / 2 + std::max(0, k - 3) * 2 + 1;\n        mat.a[0][1] = n - k + 1, mat.a[0][2] = n - k + 1;\n        mat.a[1][0] = k - 2, mat.a[1][1] = 1ll * (n - 3) * (n - 2) / 2 + n - k + k - 2, mat.a[1][2] = 1, mat.a[1][3] = n - k;\n        mat.a[2][0] = k - 2, mat.a[2][1] = 1, mat.a[2][2] = mat.a[1][1], mat.a[2][3] = n - k;\n        mat.a[3][0] = 0, mat.a[3][1] = mat.a[3][2] = k - 1, mat.a[3][3] = 1ll * (n - 3) * (n - 2) / 2 + std::max(0, n - k - 1) * 2 + 1;\n        mat = quick_pw(mat, m);\n        std::array<modint, 4> res{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < 4; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < 4; ++j)\n                res[i] += v[j] * mat.a[j][i];\n        ans += res[1] + res[2];\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"J1rJd7mqMooPnPxJp91cKeCjnbd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"第二种解法：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"M2xbdjbXLomUgMxgWXRcQzkBnqe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"实际上这种可以分拆贡献的题目，一般都直接考虑贡献——即","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[j]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"如何向答案提供贡献。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KfXDdu4OSoz1mkx1rBac7AROnvc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"对于这种交换操作，有一个普适的做法。来源于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"P4223 期望逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fwww.luogu.com.cn%2Fproblem%2FP4223"},"strikethrough":false,"text_color":7,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"text_color":7,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HKf7d7NKyopEMmxlMFsckUGDnWe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"考虑两个位置","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，其数字是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{L}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，设其它数字是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。经过交换之后，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"上的数字会有七种状态——","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R),(A_L,A_{other}),(A_R,A_L),(A_R,A_{other}),(A_{other},A_L),(A_{other},A_R),(A_{other},A_{other})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GnNDdIQTcom7nJxo8Sscugkbnzg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"同样跟解法1一样，写出矩阵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Mat","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"D6MqdiXnioSxpMxJhEpcdvdpnrf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"Mat=\\begin{bmatrix}\nC_{n-2}^{2}&n-2&1&0&0&n-2&0\\\\\n1&C_{n-2}^2+n-3&0&1&1&0&n-3\\\\\n1&0&C_{n-2}^2&n-2&n-2&0&0\\\\\n0&1&1&C_{n-2}^{2}+n-3&0&1&n-3\\\\\n0&1&1&0&C_{n-2}^{2}+n-3&1&n-3\\\\\n1&0&0&1&1&C_{n-2}^{2}+n-3&n-3\\\\\n0&1&0&1&1&1&C_{n-2}^2+2(n-4)+1\\\\\n\\end{bmatrix}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"OyUYdYft8oWQvkxWriscZUOTnsg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"通过初始向量","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v=(1,0,0,0,0,0,0)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v*=Mat^M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，这样任意两个位置在交换","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次之后的状态以及对应的方案数都确定了。接下来考虑贡献。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"I2CpdLPZloSbw7xmZmicbiminvf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"因为这里的贡献只有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P[i+1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，考虑在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次交换之后，各状态对答案的贡献。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ujlld3RFbo4vQfx9nrScsKN6nTh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先最好考虑的就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"以及","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_R,A_L)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"两个状态的贡献。显然是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(v[0]+v[2])\\times|P[i]-P[i+1]|\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_{other},A_L)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，因为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"n-2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种可能，每种可能性出现的次数都是均等的，所以单个可能是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{v[1]}{n-2}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(x)=\\sum_{i=1}^N|i-x|","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，贡献数是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{v[1]\\times[f(P[i])-|P[i]-P[i+1]|]}{n-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。接下来的贡献同理。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DoKMd6YsGoNFz0xT7qHcjWMMnac","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"考虑状态","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_{other},A_{other})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的贡献数。一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(n-2)(n-3)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种均等的可能性。通过枚举第一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的值，可以得到贡献为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{v[6]\\times(\\sum_{x=1}^Nf(x)-2f(P[i])-2f(P[i+1])+2|P[i]-P[i+1]|)}{(n-2)(n-3)}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"N6xfd74RUoFjtLxlzuIcEsNrntg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"最终复杂度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N+7^3log_{2}M)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UBhrdvOfEoZQWsxYnS3cWCEPn2c","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/modint>\nusing modint = atcoder::modint998244353;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"template","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" <","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"class","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" T, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" SIZE = 2>\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Matrix\n{\n    std::array<std::array<T, SIZE>, SIZE> a{};\n\n    Matrix(T v = 0)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < SIZE; ++i)\n            a[i][i] = v;\n    }\n    Matrix operator*(const Matrix &rhs) const\n    {\n        Matrix res{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < SIZE; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < SIZE; ++j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 0; k < SIZE; ++k)\n                    res.a[i][j] += a[i][k] * rhs.a[k][j];\n        return res;\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::array<T, SIZE> &operator[](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i)\n    {\n        return a[i];\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    const std::array<T, SIZE> &operator[](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i) const\n    {\n        return a[i];\n    }\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"template","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" <","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"class","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" T>\nT quick_pw(T a, ll b)\n{\n    static T I{1};\n    if (b == 0)\n        return I;\n    Matrix ans = I, base = a;\n    while (b)\n    {\n        if (b & 1)\n            ans = ans * base;\n        b >>= 1;\n        base = base * base;\n    }\n    return ans;\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> p(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(p[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> pos(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        pos[p[i]] = i;\n\n    std::vector<modint> f(n + 1);\n    f[1] = 1ll * n * (n - 1) / 2;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 2; i <= n; ++i)\n        f[i] = f[i - 1] + i - 1 - (n - i + 1);\n    modint sum = std::accumulate(f.begin(), f.end(), modint(0));\n    Matrix<modint, 7> M{};\n    modint c_n_2_2 = 1ll * (n - 3) * (n - 2) / 2;\n    modint inv_n_2 = 1, inv_n_3 = 1;\n    if (n - 2)\n        inv_n_2 /= (n - 2);\n    if (n - 3)\n        inv_n_3 /= (n - 3);\n    M[0][0] = c_n_2_2, M[0][1] = n - 2, M[0][2] = 1, M[0][5] = n - 2;\n    M[1][0] = 1, M[1][1] = c_n_2_2 + n - 3, M[1][3] = M[1][4] = 1, M[1][6] = n - 3;\n    M[2][0] = 1, M[2][2] = c_n_2_2, M[2][3] = M[2][4] = n - 2;\n    M[3][1] = M[3][2] = 1, M[3][3] = c_n_2_2 + n - 3, M[3][5] = 1, M[3][6] = n - 3;\n    M[4][1] = M[4][2] = 1, M[4][4] = M[3][3], M[4][5] = 1, M[4][6] = n - 3;\n    M[5][0] = M[5][3] = M[5][4] = 1, M[5][5] = c_n_2_2 + n - 3, M[5][6] = n - 3;\n    M[6][1] = M[6][3] = M[6][4] = M[6][5] = 1, M[6][6] = c_n_2_2 + 2 * (n - 4) + 1;\n    M = quick_pw(M, m);\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = M[0];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n - 1; ++i)\n    {\n        modint diff = std::abs(p[i] - p[i + 1]);\n        ans += (v[0] + v[2]) * diff;\n        ans += (v[1] + v[4]) * inv_n_2 * (f[p[i]] - diff);\n        ans += (v[3] + v[5]) * inv_n_2 * (f[p[i + 1]] - diff);\n        ans += v[6] * inv_n_2 * inv_n_3 * (sum - 2 * (f[p[i]] + f[p[i + 1]]) + 2 * diff);\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" TestCases = 1;\n    if constexpr (MultiTestCases == 1)\n        scanf(\"%d\", &TestCases);\n\n    while (TestCases--)\n        Main();\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"WfERdpn7NoDW7HxV8dIcUOQmngb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：新的东西出现了！第一个是切糕模型，这种拆贡献的方式确实厉害了。第二个是这个矩阵的做法，任意且独立的多次操作，状态压缩之后通过矩阵推导最终状态的方案，然后再单独算贡献。相当于把可能性都展现出来，然后只用考虑单次操作对状态的变化（就简单很多），最终利用快速幂来压缩运算。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EhErdJyzdogUVlxV6ADcZoo8nuh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"要去补一下提到的两道题。留个白先。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AoUkdWHMvoA3JIxReOIcVSWlnSh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"切糕问题：看了一眼感觉跟这题没啥关系啊，可能他的切糕模型跟那个题不一样吧。这个建模是指在最小割里面怎么添加无穷容量的边的问题；","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","block_type":34,"children":["KO4kdIbqKoeAcVxCgPuc7PJfnBl","WIGadP9vFoAJLixVbYhcKQmGnUb","AHGVdnKmRoT1nMxp3fdch55Anng","E30jdmlsVoEPnDxu29ecXrDJn38","MRbndH8llo0EVtxcgIjcJig8nAG","Wm7odtws9o6imixaDapchz4NnPe","CBmyd0yKaojszBx0D41cp62vnJe","CxkCdvSyRojaKHxQyg9c1E2rnXb","FhlUd0EnhoeSWExA7lsch3Linac","UDuLdjdPqovDslxQ3mZcvDpxnjf","E2Wgd0qf7oQ56ixWHydcFpG7nMf","NWMqdo6HSooR4AxZQq6cs4w0n8f"],"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","quote_container":{}},{"block_id":"KO4kdIbqKoeAcVxCgPuc7PJfnBl","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"text_run":{"content":"P4223 期望逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fwww.luogu.com.cn%2Fproblem%2FP4223"},"strikethrough":false,"text_color":7,"underline":false}}},{"text_run":{"content":"：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"text_color":7,"underline":false}}},{"text_run":{"content":"一个排列，每轮任选两个数交换，一共","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"轮，求所有操作序列最终带来的逆序对总和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WIGadP9vFoAJLixVbYhcKQmGnUb","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"text_run":{"content":"就直接从7种状态对答案的贡献开始讨论好了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AHGVdnKmRoT1nMxp3fdch55Anng","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，说明原先是一个逆序对；","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"E30jdmlsVoEPnDxu29ecXrDJn38","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_R,A_L)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，说明原先是一个顺序对；","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MRbndH8llo0EVtxcgIjcJig8nAG","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_{other}, A_L)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}>A_L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}\\neq A_R\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么对于原先的一个顺序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{N-A_L-1}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；对于一个逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{N-A_L}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Wm7odtws9o6imixaDapchz4NnPe","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_{other}, A_R)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}>A_R\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}\\neq A_L\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么对于原先的一个顺序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{N-A_R}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；对于一个逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{(N-A_R-1)}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CBmyd0yKaojszBx0D41cp62vnJe","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_{L}, A_{other})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}<A_L\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}\\neq A_R\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么对于原先的一个顺序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{A_L-1}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；对于一个逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{A_L-2}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CxkCdvSyRojaKHxQyg9c1E2rnXb","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_{R}, A_{other})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"对答案产生贡献，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}<A_R\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A_{other}\\neq A_L\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么对于原先的一个顺序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{A_R-2}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；对于一个逆序对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(A_L,A_R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，提供的贡献是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{A_R-1}{N-2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FhlUd0EnhoeSWExA7lsch3Linac","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"equation":{"content":"(A_{other},A_{other})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，产生","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{1}{2}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的贡献，且对于每一对数都成立","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UDuLdjdPqovDslxQ3mZcvDpxnjf","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"E2Wgd0qf7oQ56ixWHydcFpG7nMf","block_type":2,"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf","text":{"elements":[{"text_run":{"content":"那么就直接在求顺序对和逆序对的时候直接计算贡献即可","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NWMqdo6HSooR4AxZQq6cs4w0n8f","block_type":14,"code":{"elements":[{"text_run":{"content":"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, k;\n    read(n, k);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> p(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(p[i]);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    FenwickTree<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> fwt(n);\n    modint ans = 0;\n    Matrix<modint, 7> M{};\n    modint c_n_2_2 = 1ll * (n - 3) * (n - 2) / 2;\n    M[0][0] = c_n_2_2, M[0][1] = n - 2, M[0][2] = 1, M[0][5] = n - 2;\n    M[1][0] = 1, M[1][1] = c_n_2_2 + n - 3, M[1][3] = M[1][4] = 1, M[1][6] = n - 3;\n    M[2][0] = 1, M[2][2] = c_n_2_2, M[2][3] = M[2][4] = n - 2;\n    M[3][1] = M[3][2] = 1, M[3][3] = c_n_2_2 + n - 3, M[3][5] = 1, M[3][6] = n - 3;\n    M[4][1] = M[4][2] = 1, M[4][4] = M[3][3], M[4][5] = 1, M[4][6] = n - 3;\n    M[5][0] = M[5][3] = M[5][4] = 1, M[5][5] = c_n_2_2 + n - 3, M[5][6] = n - 3;\n    M[6][1] = M[6][3] = M[6][4] = M[6][5] = 1, M[6][6] = c_n_2_2 + 2 * (n - 4) + 1;\n    M = quick_pw(M, k);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = M[0];\n    modint n_2_inv = n - 2 ? modint(n - 2).inv() : 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n        modint ord = fwt.query(p[i]), inv = i - 1 - ord;\n        ans += ord * v[2] + inv * v[0];\n        ans += inv * (p[i] - 1) * n_2_inv * v[3] + ord * (p[i] - 2) * n_2_inv * v[3];\n        ans += inv * (n - p[i] - 1) * n_2_inv * v[5] + ord * (n - p[i]) * n_2_inv * v[5];\n        fwt.modify(p[i], 1);\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        fwt.modify(p[i], -1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = n; i >= 1; --i)\n    {\n        modint inv = fwt.query(p[i]), ord = n - i - inv;\n        ans += inv * (p[i] - 2) * n_2_inv * v[1] + ord * (p[i] - 1) * n_2_inv * v[1];\n        ans += inv * (n - p[i]) * n_2_inv * v[4] + ord * (n - p[i] - 1) * n_2_inv * v[4];\n        fwt.modify(p[i], 1);\n    }\n    ans += 1ll * n * (n - 1) / 2 * modint(2).inv() * v[6];\n    printf(\"%d\\n\", ans);\n\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"QpVddrFIsoRNoqxt8jTcbkzCnlf"},{"block_id":"MK19dXRm0o8NBjxLOoycKQ2MnVf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"P.S.：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"indentation_level":"NoIndent"}}},{"block_id":"ZbdmduekfoHJgBxeGxJcdZeEnzh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"两种做法差好多啊。。。第一个做法有一个64的常数。但第二个做法写矩阵有点痛苦...","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HEyrdx0tmoj9IVxFLlBcaLZInSc","block_type":27,"image":{"align":2,"height":145,"token":"G9jAbu92AoVhwuxdPV5cTSqFnog","width":2407},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"R52pd6AKBozExkx33NjckKzUnof","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC163D.Sum of SCC","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc163%2Ftasks%2Farc163_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"WGYbdyeRyoS7FBxJ1N6ckP1cnNg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的竞赛图，需要有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条边是从小编号连到大编号。问所有满足条件的图，强连通分量（SCC）的总数是多少。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Yicsdi40coXqeYxwnoJcWTbWnke","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq30, M\\leq \\frac{N(N-1)}{2}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WwMIdMRnsovHQ4xyIPecRoPpndb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TNnZdewxjokBpPxa2GvcFPkJnmT","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"竞赛图是把一个完全图的边定向之后的有向图。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QAyydYCRhocfKRxMjbhcuTqnn2f","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样的话把竞赛图进行SCC缩点，会形成一条链，且每个节点向后续节点都有边。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YG6sdtXUdoX07vxdCVwczm98nZd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"每个SCC的大小，节点编号都很难确定。直接从SCC的角度考虑很费劲。而且","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条边从小编号连到大编号这种限制，似乎感觉在告诉我们从小到大加节点，然后给边定向，这样方便满足这个限制。这样的话每次加一个节点，还可能会破坏之前枚举的SCC的链结构。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IMUodcYmvovXTRxdbyPcpRI4n4f","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"直接计数很费劲的话，考虑能否构造一一映射。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RoE3dXrlWoVWRDxAA2dcQnEGnEd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个定理：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IeqhdvQtAoF2otxVGDWcUVJnnRx","block_type":34,"children":["M9vad2tifooNpgxnDqcchJJXnHc"],"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","quote_container":{}},{"block_id":"M9vad2tifooNpgxnDqcchJJXnHc","block_type":2,"parent_id":"IeqhdvQtAoF2otxVGDWcUVJnnRx","text":{"elements":[{"text_run":{"content":"考虑将图分为两个集合","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"非空)，使得两个集合之间，只有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"连到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的边。竞赛图的SCC个数，等价于这个集合划分方案数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WLQhdEUUOoqI66xj3psc2Iuon7Q","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"实际上这个定理是缩链之后的一个引理。因为划分集合的方案，等价于在这条链上按拓扑序一分为二，显然是SCC-1种切分。这样如果","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"不为空","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"可以为空，就恰好是SCC的个数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Co2EdWsUaoB7v2xf4wEcoEQbnld","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样就可以考虑维护这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合。枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合，每次加一个新节点进来只需要考虑两个决策——节点分在哪个集合中。发现新节点构造边的方案数实际上只跟","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合的大小有关，那么压缩","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合的状态为枚举大小。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YJUvdxQ8ooaKDdx7354cgsizneb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[i][j][k]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合大小为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，满足条件的边有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GGvCds14foIMvCxpMBLc39vPnnf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"分到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合中，首先","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"向","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合连边，编号从大连到小；剩下的边在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合内部，可以随意连。设有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点连向","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，则","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i+1][j+1][k+x] += dp[i][j][k]\\times C_{j}^{x}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"I6Hnd5nHvoYt37x4a0XcnkPanmd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"分到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合中，那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合所有点向","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"连边，编号从小连到大；剩下的边在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"集合内部，设有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点连向","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，则","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i+1][j][k+j+x] += dp[i][j][k]\\times C_{i-j}^{x}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Qb0Hd6tMQoCriRx7vPYcYXzKnie","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"最终去掉空集","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的方案即可；否则，对于每一种可能的图都多加了1，要减去","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2^{\\frac{N(N-1)}{2}}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Qg8jd5WpCo4q8xxv9DocLkJqnHW","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/modint>\nusing modint = atcoder::modint998244353;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n    std::vector dp(n + 1, std::vector(n + 1, std::vector<modint>(m + 1)));\n    std::vector C(n + 1, std::vector<modint>(n + 1));\n    C[0][0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n        C[i][0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= i; ++j)\n            C[i][j] = C[i - 1][j - 1] + C[i - 1][j];\n    }\n    dp[0][0][0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < n; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j <= i; ++j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 0; k <= m; ++k)\n            {\n                if (dp[i][j][k] == 0)\n                    continue;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x = 0; x <= j; ++x)\n                    if (k + x <= m)\n                        dp[i + 1][j + 1][k + x] += dp[i][j][k] * C[j][x];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x = 0; x <= i - j; ++x)\n                    if (k + j + x <= m)\n                        dp[i + 1][j][k + j + x] += dp[i][j][k] * C[i - j][x];\n            }\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < n; ++i)\n        ans += dp[n][i][m];\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"KtKMdrbdCozR7ExvELFcHJ0mnnc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：我是想不出来的...首先这个编号的限制我就没想明白，现在复盘一下觉得这是从小到大加点的一个提示。接下来是这个构造一一映射的过程，这确实计数题的一个比较典型的解法。由于SCC的结构很难用DP状态来表示，构造了这个一一映射，直接简化了问题，而且每个新节点的决策只有两种，太厉害了。感觉有的时候，有一些很冷门的知识点，如果能想到就能解决问题，比如这个竞赛图的集合划分方案，以及之前做过的一个数组LCM的问题——那道题需要知道若干数的最小公倍数的质因数分解中每个因数的指数是数组中该因数的最大指数，当然那道题我想到了，这个状态就可以用一个bitmask来表示。的确有时候需要这种灵感以及知识点，灵感这个东西靠经验，知识点就得靠积累了，多做题肯定是没错的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AR8ddCXAgoOIG2xVrUbcUw5Vnae","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SjwwdIAY2oXH4txv3Dbcz3RVnFc","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC321G.Electric Circuit","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Fabc321%2Ftasks%2Fabc321_g"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"DJ9Kd2Cb3oIj9pxhUIgcyVcDnEe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的图，两个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。每次加边选择","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中没被选择的一个，一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M!","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种加边方法。求所有加边方法，最终形成的连通块数量的期望","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"C4m7dzthCoQvkmxn1XgcN9Qangb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"M\\leq 10^5, N\\leq17\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GcP6d4BeGoTuybxFIECcGtf4nIZ","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KKhTd5z0coYFYHx236gcDXtvnxu","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"因为一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M!","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种加边法，所有求所有加边法的连通块总数即可。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PAuJdzUVCoLjAhx9g0xcYChYn0e","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"很自然能想到枚举连通块的点集，为总数做贡献。设点集为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的单个连通块的构建方法为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(S)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，点集","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中各出现了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次，显然对总数的贡献是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(S)*(M-k)!","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Kg4zdstSnoAV3DxSWitckeBynda","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"求","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(S)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"感觉很困难，此时我想到利用前缀和差分的方式求。但觉得复杂度高弃了真是有点大病。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Lqs4dbjnJolZGaxyRRLcfnB2nye","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"点集为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"S","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的点，连边的方案一共是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k!","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。取这个点集的一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"l\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的子集划分","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"{s_1,...,s_l}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。每一个不同的子集划分，方案是不会有重复的。这样","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k! = \\sum_{S=\\{s_1,...,s_l\\}} \\prod_{i=1}^{l}f(s_i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(S)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"就等价于长度为1的子集划分。这样可以枚举子集做一个差分，为了避免重复计算，取点集最大编号的那个点所在的集合","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s_l","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"来做。即","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(S)=k!-\\sum_{s_l}f(s_l)[\\sum_{S-s_l = \\{s1,...,s_l-1\\}}\\prod_{i=1}^{l-1}f(s_i)]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，后面的显然可以利用前缀和一类的东西来计算子问题。这样就做完了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FpQkddlA2oYRjNxKPjfc5imOn8b","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/modint>\nusing modint = atcoder::modint998244353;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::array<std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">, 2> a{std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(m + 1), std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(m + 1)};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p = 0; p < 2; ++p)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n            read(a[p][i]), a[p][i]--;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::array<std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">, 2> cnt{std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(n), std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(n)};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p = 0; p < 2; ++p)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n            cnt[p][a[p][i]]++;\n\n    std::vector<modint> factor(m + 1);\n    factor[0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        factor[i] = factor[i - 1] * i;\n\n    std::vector<modint> f(1 << n), g(1 << n);\n    f[0] = 1;\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mask = 1; mask < (1 << n); ++mask)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mx = -1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2> tmp{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < n; ++i)\n            if (mask & (1 << i))\n                mx = i, tmp[0] += cnt[0][i], tmp[1] += cnt[1][i];\n        if (tmp[0] != tmp[1])\n            continue;\n        modint all = factor[tmp[0]];\n        g[mask] = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" S = (mask ^ (1 << mx)), T = S; T; T = (T - 1) & S)\n            g[mask] += g[T] * f[mask ^ T];\n        f[mask] = all - g[mask];\n        g[mask] += f[mask];\n        ans += f[mask] * factor[m - tmp[0]];\n    }\n\n    printf(\"%d\\n\", ans / factor[m]);\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"C4OMdRbcZoc5Kex5O1ec7eyYnmb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：不能因为感觉困难就放弃思考放弃治疗啊！！！明明自己已经整理过反演相关的东西了，为什么放弃治疗了！！","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"U9ZfdQbTQoMZFcx3lcvcc6irnUf","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC165D.Substring Comparison","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc165%2Ftasks%2Farc165_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"CnXrd7UuboBIylxU7EAcG9PIn1c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设有一个长为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"字符串","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，给出","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条限制，每条限制是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X[A_{i},B_i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在字典序上比","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X[C_i,D_i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"小。求是否有这样的字符串。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RMRodUbrqoNqVvxNJjnciKzln1e","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq 2000, M\\leq 2000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TIbdd2LZXoseBAx5QEAcwSRanpL","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IRa2diqwsosKPTxDYjXc1Z3YnDc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"考虑字典序小，说明可能有一段LCP，然后在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X[A_i+LCP]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X[C_i+LCP]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的地方比出大小。一般这种给出","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条限制的可以按图论考虑。这样就可以利用有向图来刻画“小于”的偏序关系。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Wipxdo13NoOA4BxeRfCcZleQnSc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"维护每个限制的LCP，将当前要比较的一位按偏序连边。如果最终这个图出现了自环或者SCC，说明有当前偏序未能满足，且有部分位置的字符一定是相等的，这时将未能满足的限制的LCP加1，重复这个过程。注意到每次新过程需要保存老过程的SCC，因为需要维护字符的相等，这样每轮的图边数一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(NM)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条，会TLE。实际上老过程的SCC可以直接用DSU缩点，这样每轮的图边数一共有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(M)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"条。另外如果出现了新的SCC，会多跑一轮，一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的图，SCC数量只会从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"减到1，这样出现新的SCC时，相当于缩点之后的图节点变少了，于是最多跑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"轮。复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N(N+M))\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UnUDdWrXioVciyxJ1WgcOM89ngc","block_type":14,"code":{"elements":[{"text_run":{"content":"\n#include <atcoder/dsu>\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> Tarjan(std::vector<std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> &G, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n)\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> dfn(n + 1), low(n + 1), scc(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::stack<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> stack;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> ins(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" stamp = 0, cnt = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":")> tarjan = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u)\n    {\n        // int t, minc = low[v] = pre[v] = cnt++;\n        stack.push(u), ins[u] = true;\n        dfn[u] = low[u] = ++stamp;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : G[u])\n        {\n            if (!dfn[v])\n            {\n                tarjan(v);\n                low[u] = std::min(low[v], low[u]);\n            }\n            else if (ins[v])\n                low[u] = std::min(low[u], dfn[v]);\n        }\n        if (dfn[u] != low[u])\n            return;\n        cnt++;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" t = 0;\n        do\n        {\n            ins[t = stack.top()] = false;\n            scc[t] = cnt;\n            stack.pop();\n        } while (t != u);\n    };\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        if (!dfn[i])\n            tarjan(i);\n    return {cnt, scc};\n}\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 5>> e(m + 1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &[a, b, c, d, lcp] = e[i];\n        read(a, b, c, d);\n        lcp = 0;\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector adj(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">{});\n\n    atcoder::dsu dsu(n + 1);\n\n    while (true)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n            adj[i].clear();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"bool","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" self_loop = false;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [a, b, c, d, lcp] = e[i];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u = a + lcp, v = c + lcp;\n            if (u > b)\n                continue;\n            u = dsu.leader(u), v = dsu.leader(v);\n            adj[u].push_back(v);\n            self_loop |= (v == u);\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [cnt, scc] = Tarjan(adj, n);\n        if (cnt == n && !self_loop)\n            return printf(\"Yes\\n\"), 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &[a, b, c, d, lcp] = e[i];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u = a + lcp, v = c + lcp;\n            if (u > b)\n                continue;\n            u = dsu.leader(u), v = dsu.leader(v);\n            if (scc[u] == scc[v])\n                lcp++, dsu.merge(u, v);\n            if (lcp == d - c + 1)\n                return printf(\"No\\n\"), 0;\n        }\n    }\n    printf(\"No\\n\");\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"RjWZdvMHioSK2wxEyVmcT9Kpn2b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：我自己分析出来了，有点开心，这里有点后缀数组倍增的意思，实际上考虑LCP是字典序的典型解法。然后复杂度分析那块稍微卡住了，但是考虑了一下缩点，这样每轮甚至轮数都确定了，还是挺妙的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EYyrduEPbosi0hxyWjFczM63njd","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC168D.Maximize Update","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc168%2Ftasks%2Farc168_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"BavEdvuG0oW4L3xK0ovclpPXnAh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"在一行里有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个方格，有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种操作","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，表示将","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[L_i,R_i]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这个区间全染黑；如果这个区间已经黑了就不能染了。问最多能进行几次操作。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GcUKdpOpQo0DtPxXATvcSt1tnwe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq500","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HKSVdAkvUo3jzNxBnPJcdhKJn2f","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PwnddETqNoTxQpxKmxXc0pURnrd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这个数据类型就挺区间DP的。然后考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[l][r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"区间最多进行几次操作，注意这里所有的操作都不能超过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。然后就是枚举最后一个染黑的点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mid","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，这个点目前是白的，所以之前的操作都不会越过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mid","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，归约到子问题","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[l][mid-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[mid+1][r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。当然这个点能操作当且仅当在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中包含一个能染","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mid","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的操作。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UGWedIQTjoEQ8KxupDPc0gElnod","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">> a(m + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &[l, r] = a[i];\n        read(l, r);\n    }\n    std::sort(a.begin() + 1, a.end());\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector dp(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(n + 1, 0));\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= m; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [l, r] = a[i]; l == r)\n            dp[l][r] = 1;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector ok(n + 1, std::vector(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">(n + 1)));\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= m; ++j)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [l, r] = a[j];\n            if (l <= i && r >= i)\n                ok[i][l][r] = 1;\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l = n; l >= 1; --l)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r = 1; r <= n; ++r)\n            {\n                if (l - 1 >= 1)\n                    ok[i][l - 1][r] |= ok[i][l][r];\n                if (r + 1 <= n)\n                    ok[i][l][r + 1] |= ok[i][l][r];\n                if (l - 1 >= 1 && r + 1 <= n)\n                    ok[i][l - 1][r + 1] |= ok[i][l][r];\n            }\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" len = 2; len <= n; ++len)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l = 1; l <= n; ++l)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r = l + len - 1;\n            if (r > n)\n                break;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mid = l; mid <= r; ++mid)\n                if (ok[mid][l][r])\n                    dp[l][r] = std::max(dp[l][r], ((l <= mid - 1) ? dp[l][mid - 1] : 0) + ((mid + 1 <= r) ? dp[mid + 1][r] : 0) + 1);\n        }\n\n    std::cout << dp[1][n] << std::endl;\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"B5yydPUZ8o2M1bxTJ2acv7PFnKJ","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：挺直觉的，但是国外给的难度评级比较高，难道区间DP是CN强项？当然如果要很严谨地证还是有点复杂。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"L2o0dQOG5ov27Xx47tmc5mmVnAg","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC162D.Smallest Vertices","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fatcoder.jp%2Fcontests%2Farc162%2Ftasks%2Farc162_d"},"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"DbV1d8cDooY47JxBqlFcu9vWnmi","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设一棵以1为根的有根树有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，每个节点的出度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ER8vdbaN0oHbzCxf25Ycggf4nvB","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"求所有这样的树里面，子树的根节点是子树编号最小的那个点，这样的点的总数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TxkLd0Ln6ob8duxkAJjcSBKZn0g","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq500\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FUGAdFiuVoEsPWxZ088cFRrEnhb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GQvzdA31HoiH5XxbmeecZrDXnSb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一开始看到是有根树的感觉有点复杂，后来一看以1为根，那不就是无根树的数量。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"P4KidY0wmoRVCCxK5lycz1jOnzI","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"给出每个点的出度，即意味着除了根节点外每个点度数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"deg_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"都是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d_i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。给出点度数求树的数量，显然Prufer序列。在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N-2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个格子里面，点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"出现了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"deg_i-1\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次。方案就是多重组合数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{(N-2)!}{\\prod_{i=1}^N(deg_i-1)!}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。原来出度是为了让我们不用减1了？Atcoder你人还怪好的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"V05RdmoBToY679xzxrqcc6KZn3c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"然后考虑一个节点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"作为根的时候是子树编号最小的点。发现这样的话就相当于从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[v+1,N]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面拿一些节点凑成一个子树。显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树有若干形状，而","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树外面也有若干形状。假设拿取的点是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"t_1,...t_k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树的方案有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{(k-1)!}{\\prod_{i=1}^k(d_{t_i}!)\\times (d_v-1)!}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树外的方案相当于把","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树当做一个叶子，再凑成一个新树，方案是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{(N-k-2)!}{\\prod_{i=2}^{N}[i \\notin t](d_i)! \\times (d_1-1)!}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这俩乘在一起，发现分母就是算树总数的那个分母，只不过少乘了一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d_v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{(k-1)!(N-k-2)!d_v}{\\prod_{i=2}^{N}(d_i)! \\times (d_1-1)!}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是分母就能预处理出来。分子发现只跟","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"有关。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CfF2dV2VVoHrTnxVkUwcJg0Lnrd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接下来考虑如何从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[v+1,N]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面拿子树。显然点度数的和要符合条件，一个大小为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的子树，节点的出度和应为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。又因为不管我们怎么取子树，上面式子的分母都是一样的，所以求一个方案数当做系数就行了。因此相当于做一个背包，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i][j][k]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[i,N]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面拿取","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，度数和为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的方案，按01背包去做就行了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EDfydSDStoQ3RHxspS5cf4n3nfe","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" N;\n    read(N);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> d(N + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        read(d[i]);\n    Combinatorics<modint> combinatorics(N);\n    std::vector dp(N + 2, std::vector(N + 1, std::vector<modint>(N + 1, 0)));\n    dp[N + 1][0][0] = 1;\n    // (S-2)!/(d[i]!)*(d[v]-1)! * (N-S-2)!/(d[j]!)*(d[1]-1)!\n\n    modint frac = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 2; i <= N; ++i)\n        frac *= combinatorics.invfac[d[i]];\n    frac *= combinatorics.invfac[d[1] - 1];\n    modint ans = combinatorics.fac[N - 2] * frac;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = N; i >= 2; --i)\n    {\n        if (d[i] == 0)\n            ans += combinatorics.fac[N - 2] * frac;\n        else\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = d[i] + 1; j <= N - i + 1; ++j)\n                ans += dp[i + 1][j - 1][j - 1 - d[i]] * frac * d[i] * combinatorics.fac[j - 2] *\n                       ((N - j - 1 >= 0) ? combinatorics.fac[N - j - 1] : 1);\n        }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j <= N - i + 1; ++j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 0; k <= N - 1; ++k)\n            {\n                dp[i][j][k] += dp[i + 1][j][k];\n                if (j >= 1 && k >= d[i])\n                    dp[i][j][k] += dp[i + 1][j - 1][k - d[i]];\n            }\n    }\n    printf(\"%d\\n\", ans);\n\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"YVeVdlatjo1XvgxjxCdcPpEGnIb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：最近看房子，没有很认真地用纸笔推演。甚至一开始看错题了怎么都做不出来。最终在脑子里大致推出来一个型，虽然那个型没考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"子树外的情况，但好在在洗碗的时候意识到了...全程意识流，感觉Prufer序列处理点度数问题是一个经典思路，我也是从那道生成函数里学到的。感觉多做难题会学会很多知识点？按质因数状态做容斥也是在一个CF 3000分左右的题里面学到的。是不是应该考虑加大平时做题难度了呢。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Re5fdF9f0oBntrxWMq4cVZ7qnbc","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC248G.GCD cost on the tree","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"TSRtd7pX2o4pOJxZYMOcZW84ngG","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一棵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的树，点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的点权为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HJCsdrdD6owJlMxiUGHcnUPonzd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一条从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"u","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的路径权值被定义为路径上点权的GCD和路径点数的乘积。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JxERdllp0o8Tc6xnPeuc1LYonJd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"求这棵树所有路径的权值和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N\\leq 10^5, a[i]\\leq 10^5","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KGBXdoq8XoJn0UxM1b8cWtbcnDb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RpcfdQeElohEiaxbl1UcZItwndT","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这种关于多个节点GCD相关的题目，一般来说可以考虑枚举公共约数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，这样抽出部分节点，直接求解。接下来做一步差分或者叫容斥。设公共约数为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的问题答案为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(d)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，则最大公约数为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的问题答案为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g(d)=f(d)-\\sum_{i=2}^{i*d\\leq N}g(i*d)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这一步复杂度为调和级数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CVUfdVRXco0b2Rx0VLrc5YiZnid","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"对于这道题目也是一样的，假设约数为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的节点形成的森林","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，对于这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"求出路径长度的和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f(d)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，然后求一下","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g(d)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，最后","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"g(d)*d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"加到答案上。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Hp3pdSDmEoAUejxE5k6c6HdUnUe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"复杂度的话，对于每个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，约数最多大概是200个左右。那么所有森林的节点和为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"200*N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，配合8s的时限可以接受。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DsqUd2mZxoSH8jxOE07cDLxPnJg","block_type":14,"code":{"elements":[{"text_run":{"content":"#include <atcoder/modint>\nusing modint = atcoder::modint998244353;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    read(n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> a(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        read(a[i]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" mx = *std::max_element(a.begin(), a.end());\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector b(mx + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j * j <= a[i]; ++j)\n        {\n            if (a[i] % j)\n                continue;\n            b[j].push_back(i);\n            if (a[i] / j != j)\n                b[a[i] / j].push_back(i);\n        }\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector G(mx + 1, std::vector<std::pair<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">>{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n - 1; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, v;\n        read(u, v);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" gcd = std::gcd(a[u], a[v]);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j * j <= gcd; ++j)\n            if (gcd % j == 0)\n            {\n                G[j].emplace_back(u, v);\n                if (gcd / j != j)\n                    G[gcd / j].emplace_back(u, v);\n            }\n    }\n\n    std::vector<modint> f(mx + 1);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> size(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector adj(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":")> dfs1 = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" fa)\n    {\n        size[u]++;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            if (v != fa)\n                dfs1(v, u), size[u] += size[v];\n    };\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::function<modint(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":")> dfs2 = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" fa, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cnt)\n    {\n        modint res = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            if (v != fa)\n            {\n                res += 1ll * size[v] * (cnt - size[v]);\n                res += dfs2(v, u, cnt);\n            }\n        return res;\n    };\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 1; j <= mx; ++j)\n    {\n        if (b[j].size() == 0)\n            continue;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [u, v] : G[j])\n            adj[u].push_back(v), adj[v].push_back(u);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u : b[j])\n            if (size[u] == 0)\n            {\n                dfs1(u, 0);\n                f[j] += 1ll * size[u] * (size[u] + 1) / 2;\n                f[j] += dfs2(u, 0, size[u]);\n            }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u : b[j])\n            size[u] = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [u, v] : G[j])\n            adj[u].clear(), adj[v].clear();\n    }\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" d = mx; d >= 1; --d)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 2; i * d <= mx; ++i)\n            f[d] -= f[i * d];\n        ans += f[d] * d;\n    }\n    ans -= std::accumulate(a.begin(), a.end(), modint(0));\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"K6yFdyTQoo3Sx8xMLJzcFEUvnDc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：套路缝合怪。重点在于多个点的最大公约数，枚举公共约数然后做差分这一步。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ki6kdg1GDoSExwxDlvBcbATjnjg","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC127D.Sum of Min of Xor","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"GJ6IdhnzxorMiqxVbtxcIyhnnWe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有两个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"B","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Mw8rdZM6PoUVlZx1Y3bcMVA8nbd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"求","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i=1}^{N} \\sum_{j=1}^{i-1} min(A_i \\oplus A_j, B_i \\oplus B_j)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HkkPdU4ZtoX0FsxbOXyc1Vh0n8b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq 250000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vsx0d5P7toHtMZxjq23cL2Kanuf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"A[i] < 2^{18}, B[i] < 2^{18}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Wnvyd9cK0oq5ifxvkikcq0zAn9c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SN6EdM0aOol5IIxMoT3cM8pZnTg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"同一种技巧在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"CF1720D2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"link":{"url":"https%3A%2F%2Fcodeforces.com%2Fcontest%2F1720%2Fproblem%2FD2"},"strikethrough":false,"underline":false}}},{"text_run":{"content":"。对于那道题目就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]\\oplus j > a[j] \\oplus i\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。像这种交叉型的，考虑第一个出现差异的位。那么这一位之前都是相等的，就是说","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i] \\oplus j = a[j] \\oplus i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，也就等价于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i] \\oplus i = a[j] \\oplus j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是这样就不交叉了。就可以在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[j] \\oplus j","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"组成的Trie树里面操作了。当出现不同的位的时候分类讨论一下。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KsRedpkxcoPmEyxWkvXcW4ZwnZe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"对于这道题，在出现不同的位的时候，直接计算对应的异或和。相当于问题变成在一棵树的子树里面有一堆数字，求这堆数对","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的异或值的和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MLEidDL2joBj5sxyNx6cYg9GnYf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"显然是经典问题，统计每一位01的数量即可。因此在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A[i] \\oplus B[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的Trie树上做这样的操作。当出现有差异的位时，去计算异或值的和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MILIdH2hcoQcilxzcbAcfkTQnxd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(Nlog^2A)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Q5fNdsYZuomIRnxgrNUchbKdnId","block_type":14,"code":{"elements":[{"text_run":{"content":"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" XORTrie\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Info\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 18> a_cnt{}, b_cnt{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" tot = 0;\n    };\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" node\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2> trans{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cnt;\n        std::array<Info, 2> info{};\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &operator[](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i)\n        {\n            return trans[i];\n        }\n    };\n    std::vector<node> trie;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, cnt = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    XORTrie(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" _n) : n(_n), trie(std::min(1 << 19, _n * 18) + 1)\n    {\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" insert(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" a, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" b)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x = a ^ b;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 17; i >= 0; --i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" bit = (x & (1 << i)) > 0;\n            if (!trie[p][bit])\n                trie[p][bit] = ++cnt;\n            p = trie[p][bit];\n            bit = (a & (1 << i)) > 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < i; ++j)\n            {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" abit = (a & (1 << j)) > 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" bbit = (b & (1 << j)) > 0;\n                trie[p].info[bit].a_cnt[j] += abit;\n                trie[p].info[bit].b_cnt[j] += bbit;\n            }\n            trie[p].info[bit].tot++;\n        }\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ll query(","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" a, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" b)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" c = a ^ b;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" p = 0;\n        ll res = 0;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 17; i >= 0; --i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" abit = (a & (1 << i)) > 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" bbit = (b & (1 << i)) > 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" cbit = abit ^ bbit;\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" tmp = trie[p][cbit ^ 1]; tmp)\n            {\n                const Info &ainfo = trie[tmp].info[abit], &binfo = trie[tmp].info[abit ^ 1];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < i; ++j)\n                {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" ajbit = (a & (1 << j)) > 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" bjbit = (b & (1 << j)) > 0;\n                    if (ajbit)\n                        res += (1ll << j) * (ainfo.tot - ainfo.a_cnt[j]);\n                    else\n                        res += (1ll << j) * ainfo.a_cnt[j];\n                    if (bjbit)\n                        res += (1ll << j) * (binfo.tot - binfo.b_cnt[j]);\n                    else\n                        res += (1ll << j) * binfo.b_cnt[j];\n                }\n            }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" nxt = trie[p][cbit]; nxt)\n            {\n                res += (1ll << i) * trie[nxt].info[abit ^ 1].tot;\n                p = nxt;\n            }\n            else\n                break;\n        }\n        return res;\n    }\n};\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" N;\n    read(N);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> A(N + 1), B(N + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::for_each(A.begin() + 1, A.end(), read<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"decltype","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(A[0])>);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::for_each(B.begin() + 1, B.end(), read<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"decltype","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"(B[0])>);\n    XORTrie trie(N);\n    ll ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n    {\n        ans += trie.query(A[i], B[i]);\n        trie.insert(A[i], B[i]);\n    }\n    std::cout << ans << std::endl;\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"J3fId0YhAoisQyxFyRCclTbhnKd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：思路上没啥问题，很自然。写起来分类讨论那段稍微有点费劲。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"XuatdrWLJoA5m1xvuiKcqPpNn7c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"然后遇到一个坑：正常插入一个高度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"H","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的Trie树，可能会认为空间复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N*H)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。而这棵树其实最多有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2^{H+1}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，不能盲目去开","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N*H)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的空间。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Pv8udeDvloiK9WxXyTncH4agnlb","block_type":27,"image":{"align":2,"height":230,"token":"VEeXbhHDXoyU9dxBEixcwte1nzc","width":2451},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"VDfpdFTYeowCpGxM7D1c4B8FnOf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"血泪史，有血有泪，还有屎","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KPlNdkwxzocwFWxtOFUcOlbinzg","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC180D.Division into 3","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Iq5tdPPhwoHOCqx7xpjcJ7FTn1g","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"给一个长为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，每次查询给出一个区间","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[L,R]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，需要把这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[L,R]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"分为三段，每段取最大值加起来求和，求这个最小的和是多少。一共","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"Q","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次查询。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Dct9d0XlkoZ8CZxqyFxcy7yNnqg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N \\leq 250000, Q \\leq 250000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GIBKdfnEXoyhSnxbxgFcCK6lnkQ","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"C0xSdzv7roB6FEx1d15cIZSpnBd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先这个三段中，整个区间","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的最大值肯定在这里面。假设这三段为别是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L, M, R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。每段都不为空。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RBH5dMcjlolRdGxaCsjcOLGun6c","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设最大值","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mx","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，那么显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"提供的值","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"max(L) \\geq a[l]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"max(R) \\geq a[r]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么不如只取两边各一个元素。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Fo1dd98ehoSCJFxB9zzc9J54nWg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"然后考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mx\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中。假设位置是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。对于两段","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，假设枚举","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"max(R)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，求出对应的最小的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。想象有一根线，从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"开始向左滑动，发现对于这根线来说，最小的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"其实就是线左边那个单独的元素。所以相当于是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a_i +max_{j=i+1}^{r}(a_j)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。发现后面那个值跟","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"有关。不妨扫描线这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"r","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，更新这个值，这个过程就是单调栈。最终可以找到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"能作为最大值的那个区间","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[k,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，则对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[k,r-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中所有的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[i]+a[r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"都是可选的值。懒标记线段树就可以更新这个值。接下来对于一个询问，最大值在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，查询","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[p+1,r-1]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里的最小值和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[p]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"去更新答案。注意到如果最大值有多个，应该去最小的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"而不是最大的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。因为这根线的滑动范围只有一个最小的限制，如果取最大的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，有的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"就取不到了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NNZod0fG2olqN7xwbVIcKebjnxc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"对于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"mx","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面，是镜像的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ev4odSxZCoyzmexZvlUcNdTCnHf","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, q;\n    read(n, q);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3>> info(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> a(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n        read(a[i]);\n        info[i] = {a[i], i, i};\n    }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"struct","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Merge\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> operator()(const std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> &lhs, const std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> &rhs) const\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3> res{};\n            if (lhs[0] == rhs[0])\n                res[0] = lhs[0], res[1] = lhs[1], res[2] = rhs[2];\n            else if (lhs[0] > rhs[0])\n                res = lhs;\n            else\n                res = rhs;\n            return res;\n        }\n    };\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    SparseTable<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 3>, Merge> st(info, n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<std::vector<std::array<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":", 2>>> qry(n + 1), invqry(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> ans(q + 1, std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::max());\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= q; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" l, r;\n        read(l, r);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [mx, _, __] = st.query(l, r);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [mx1, _, __] = st.query(l + 1, r - 1); mx1 == mx)\n            ans[i] = std::min(ans[i], mx + a[l] + a[r]);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [mx1, L, R] = st.query(l, r - 2); mx1 == mx)\n            qry[r].push_back({L + 1, i});\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        if (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [mx1, L, R] = st.query(l + 2, r); mx1 == mx)\n            invqry[n - l + 1].push_back({n - R + 2, i});\n    }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" solve = [&]()\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        std::stack<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> stack;\n        std::vector<Info> init(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n            init[i] = {a[i]};\n        LazySegmentTree<Info, Tag> segment_tree(init, n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        a[0] = std::numeric_limits<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::max();\n        stack.push(0);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" r = 1; r <= n; ++r)\n        {\n            while (stack.size() && a[stack.top()] <= a[r])\n            {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" R = stack.top();\n                stack.pop();\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" L = stack.top();\n                L = std::max(L, 1);\n                if (L <= R - 1)\n                    segment_tree.apply(L, R - 1, {-a[R]});\n            }\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" pre = stack.top();\n            segment_tree.apply(std::max(pre, 1), r - 1, {a[r]});\n\n            stack.push(r);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [l, i] : qry[r])\n            {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" [sum] = segment_tree.query(l, r - 1);\n                ans[i] = std::min(ans[i], a[l - 1] + sum);\n            }\n        }\n    };\n    solve();\n    std::reverse(a.begin() + 1, a.end());\n    qry = invqry;\n    solve();\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= q; ++i)\n        printf(\"%d\\n\", ans[i]);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"RUZSdHyxDo7n5DxRVZjcq6rPnle","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：这个题其实做法很多的，也可以这样做：假设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[i,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里划分两段的最大值的最小和，可以发现这两段要么是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[i,i][i+1,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，要么就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[i,r-1][r,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这样感觉维护一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"然后用","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a[r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"更新一下就行了。以及细节很多：首先","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L,M,R","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"都是非空，那么最大值在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中，要用","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l+1,r-1]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的最大值和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[l,r]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的最大值比较一下，其它讨论是类似的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"G4bvdl01uoOKZTxAYt3cvGRBnug","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以关键在于能识别出来讨论最大值到底在哪这一步，我做到了。但是后面的没太细琢磨，感觉做法很多有点乱。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MSivdrH7bokKsExkVfacZt6gnge","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"接着就是对于多个最大值到底选哪一个。我一直以为备选区间越短越好，但实际上我们只是能确定最大值一定在其中一个段（比如","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里），剩下的实际上越长，备选越多，肯定不会错。假设是这种序列，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a+1,a+1,a+1,a,a+1,a+1,a+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。如果多个最大值选了最大那个，剩下只有两个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，而实际上可以是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"a+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这是我的一个坑点。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Lr6PdP0l5o3Lj3xwHcTc9DYbngc","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC212H.Nim Counting","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"AYccdAR4CoEnmpxV3JecXGOJnXg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个简单的取石子游戏，每人选一堆石子取一个或多个，不能取的人输掉。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Rq4zdjPGwo0dE4xiEd1ciquYnQc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"现在有一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"K\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"数组","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，这个取石子游戏初始每一堆石子都得是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面的一个数。对于所有不超过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"堆石子的游戏，问先手必胜的游戏数量有多少。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"BBbndWrbyoFxNExbV3lctx0qnye","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VdqIdlk9Ao3UfTxWtyNcIjSvnQe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先对于这种Nim游戏，先手必胜就是每堆石子","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"SG","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"函数的异或和不为0。由先验知识得到，最简单的这种取石子游戏","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"SG[i] = i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么题目问的就是不超过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中的数异或起来有多少种情况不为0。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HU6Nd2GnZoHLnuxXmaIcx8cTnog","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"听起来挺OGF的。单堆石子的生成函数为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F(x)=\\sum_{i=1}^K(x^{A[i]})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。如果求的是加起来有多少种情况不为0，那么显然就是这个OGF的一个幂次。而这里是异或起来的情况不为0，相当于做异或卷积的幂次。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"A4BNdSUgSozzJXxrf6Sczhoonyf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"即","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i=1}^M([x^i]\\sum_{p=1}^N F(x)^{p})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。其中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是异或值域。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KF3RdnULSoLuzvxPrimcfu0FnIf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"位运算卷积考虑快速沃尔什变换。由于沃尔什变换是线性变换，那么首先","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"XKi8dl5ZkomfaAx4xs0cj42Qn8f","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"[x^i]FWT(\\sum_{p=1}^N F(x)^{p})=\\sum_{p=1}^N[x^i]FWT(F(x)^p)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；结果的第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"项是OGF的幂次变换后第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"项的和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Th7ydOvQioha3jxvEgXcUspKnRY","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"又有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"[x^i]FWT(F(x)^p)=([x^i]FWT(F(x)))^p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；OGF的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次幂变换后第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"项等于OGF变换后第i项的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次幂。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LqWndVwBco63DcxQVKGcXRCtnNg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"把两个式子搞到一块去就发现是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EW7IdE6JaoA0F8xi9IpcTW7Ence","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"[x^i]FWT(\\sum_{p=1}^N F(x)^{p})=\\sum_{p=1}^N([x^i]FWT(F(x)))^p=\\frac{F[i](1-F[i]^{N+1})}{1-F[i]}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"等比数列求和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ToGUdIWh7oYmUxx8cA5cG9UCn0W","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样得到了沃尔什变换后的多项式，逆变换回去就可以了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HEB1dTa3soXa9pxdnbUcqrCGnGe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"时间复杂度","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O((K+M)log_2M+Mlog_2N)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。其中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是异或值域。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"THx8dsVr0ohsBwxH3FNcelKenvf","block_type":14,"code":{"elements":[{"text_run":{"content":"using modint = atcoder::modint998244353;\nusing FWT = FastWalshHadamardTransform<modint, std::__bitwise_xor>;\n\nint Main()\n{\n    int n, k;\n    read(n, k);\n    std::vector<int> a(k + 1);\n    for (int i = 1; i <= k; ++i)\n        read(a[i]);\n    int mx = *std::max_element(a.begin(), a.end());\n    int bits = std::log2(mx) + 1;\n    mx = 1 << bits;\n    std::vector<modint> f(mx);\n    for (int i = 1; i <= k; ++i)\n        f[a[i]] += 1;\n    FWT::dft(f);\n    for (int i = 0; i < mx; ++i)\n    {\n        if (f[i] == 1)\n            f[i] = n;\n        else\n            f[i] = (f[i] - f[i].pow(n + 1)) / (modint{1} - f[i]);\n    }\n    FWT::idft(f);\n    modint ans = std::accumulate(f.begin() + 1, f.end(), modint(0));\n\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"DYoedluDNoPykuxUO1ocZAQDntf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结：新知识点：快速沃尔什变换；FFT和FWT是线性变换，绝大部分的题目，要用到这一点：先按FWT变换之后的线性性质，变成点乘或者点加，再把结果IFWT回去。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Am26dXjJPoEuidxAtn4cOFNHn3e","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ABC367G.Sum of (XOR^K or 0)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"U51JdVoUkomuQ8xS6S7cI3W0nL8","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"在一个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的数组","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"A","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"中，选择一些非空子序列，这些子序列的长度都是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的倍数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FDHHdqQ5HokP7yxehdfc3mG0nWf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"一个子序列的价值为子序列异或和的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"K","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"次幂。求所有合法子序列的价值和。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N,K\\leq 2\\times10^5,M\\leq100,A[i]<2^{20}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"W3OGdFIJ3oRF26xyxUHcaBgQnYC","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JgFxdWzxrowKhKxXUWrcLE8znkf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"先考虑没有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的倍数这一限制怎么做。显然拿到每个异或和的出现次数，问题就迎刃而解。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"R3QHd6qGAovqIhxelZocTI4ynBd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"可以用OGF来刻画取子序列的过程：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\prod_{i=1}^N(1+x^{A[i]})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，乘法为异或卷积。注意去除空序列。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"YIM1d3MqboBhtJxes2GceuvznOd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么如何快速计算这个OGF的连乘？","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"TVEyd5CgqoucDBxQ9w2c7gNMnah","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"注意到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x^{A[i]}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数恒为1，由于异或卷积的性质，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+x^{A[i]})","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在FWT之后的式子中，对于每一项","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，要么提供","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+1)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数，要么提供","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1-1)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RAc6dtzHnoZgn7xgyKgc0qpFnAg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"单独拿来一个项","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，有若干个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"提供了2的系数，有若干个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"提供了0的系数，假设两者","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的数量分别为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0,c_1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。那么显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0+c_1=n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。我们要求的点乘之后的系数就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2^{c_0}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JASkdbfQooyL5qxLd7QcdIeon2f","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"现在根据点加，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"FWT(\\sum_{i=1}^N(1+x^{A[i]}))=\\sum_{i=1}^N FWT(1+x^{A[i]})\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。对于第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"项，显然FWT点加之后的系数是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2c_0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这样算一下","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"FWT(\\sum_{i=1}^N(1+x^{A[i]}))","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"就求解了每一项","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，进而能得到点乘式的系数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"D4TzdusUEoy4a0xSLXNcZnKonxd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"回到原问题，由于要考虑子序列长度的限制，设一个二元普通生成函数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F_i(x,y)=(1+x^{A[i]}y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"G1iNdmsM6oFxeAxryYgclxmgn6d","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样求解的就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\prod_{i=1}^N(1+x^{A[i]}y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，其中在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这一维做异或卷积，在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这一维做加法取模卷积。最终要找这个式子中所有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x^py^0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RkWPd8AOhoF2ISxJGvBc2gOtnBh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"依然用上述思路考虑。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QvZPdbnJzoX9QBxvyGrcDU1snhg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"(1+x^{A[i]}y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"在FWT之后的式子中，对于每一项","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，要么提供","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数，要么提供","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1-y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数。同样设前者的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个，后者有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WRpidRqLNoJ7Gkx1Ww2c1Pc1nSb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"而由点加，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"前面的系数就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0-c_1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。于是点乘式可以写成","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+y)^{c_0}(1-y)^{n-c_0}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PvskdQtKTo7bNuxJSODcXcLEntg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"对于加法取模卷积，注意到只有不超过100项。那么可以用背包DP预处理","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+y)^i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1-y)^i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。最终对每个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(1+y)^i(1-y)^{n-i}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"单独求一下","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y^0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y0[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，即可全部预处理。然后做FWT，对每一项","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"求解","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"c_0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，拿到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y0[c_0]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"y^0","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这一维的点乘式","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F'\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的系数；最终所求就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"F=FWT(F')","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"HCIadvyosomd8BxppOqc4VNGnyb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"枚举每一项，按答案所求加个权就行了。注意没有空序列。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"JYFSdIP6womhS6x5zXyccWGznYc","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" N, M, K;\n    read(N, M, K);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> a(N + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        read(a[i]);\n    std::array<std::vector<std::vector<modint>>, 2> dp{};\n    dp.fill(std::vector(N + 1, std::vector<modint>(M)));\n    dp[0][0][0] = dp[1][0][0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" k = 0, p = mod - 1; k < 2; ++k)\n    {\n        p = 1ll * p * (mod - 1) % mod;\n        // printf(\"%d\\n\", p);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < M; ++j)\n                dp[k][i][j] = dp[k][i - 1][j] + dp[k][i - 1][(j - 1 + M) % M] * p;\n        }\n    }\n    std::vector<modint> y0(N + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i <= N; ++i)\n    {\n        //(1 + y) ^ i * (1 - y) ^ (N - i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" j = 0; j < M; ++j)\n            y0[i] += dp[0][i][j] * dp[1][N - i][(M - j) % M];\n    }\n\n    //(1 + x ^ a[i] * y)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    constexpr ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" B = 20;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> diff(1 << B);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= N; ++i)\n        diff[a[i]]++;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    FWTXor<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">::dft(diff);\n    std::vector<modint> f(1 << B);\n\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < diff.size(); ++i)\n    {\n        // a + b = n, a - b = diff[i]\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" x = (N + diff[i]) / 2;\n        f[i] = y0[x];\n    }\n    FWTXor<modint>::idft(f);\n    f[0] -= 1;\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 0; i < f.size(); ++i)\n        ans += f[i] * modint{i}.pow(K);\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"QedNdZF42ooZj0xouwfcBTMhnJh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结：把上一题的技巧扩展到二元，同样求解方程式。思路依然可以先易后难，递进式思考。对于二元卷积，相当于第一维卷积之后再对另一维卷积，多元同理。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CkfFdKGiFohw92xvuHVciRConRl","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LahndkeGzoyNPZxibaHcoj6kn9k","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC165E.Random Isolation","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"BAKVduYjvoIfiVxpMDqckx37n6d","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有一棵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的树。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"D63ldLDFIoihWWxHxwbcVM3Lngf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"每次随机选一个大于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"K","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的连通块中的某一个节点，删掉这个节点及相连的边，直到没有可以选中的节点为止。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PZpGd8Cj6o9U2DxQXa1cFeIYncd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"求这个操作数的期望。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WRoXdMMhkowsg8xS9vpcJX2XnNg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq 100","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vjxzd710Bo4VuExExJFcICT1neh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CeYEdkmNvoSCWNx7Y9McizNTnZe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"首先多个点，每个点只操作一次；设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"节点的操作数，显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"X_i={0或1}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。要求的就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"E(\\sum_{i=1}^NX_i)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。由期望的线性性，这个式子等价于","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i=1}^NE(X_i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这样就把贡献单独拆到每个点上了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Sw4tdRasJoC8O2xk4rkcQEI1nmb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"由于有的节点可以选有的节点可以不选，那么对于每个节点它被选中的概率是不方便计算的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Eewwds2Pbow6fxxe9CmcTYmznQb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有一个套路是假想存在一个排列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，按照","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的顺序来操作，如果遇到了不合法的节点就跳过。这样和原问题是等价的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CtvId635qox4RHx87FocTe6EnHd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"至于原因可以这样考虑。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RJhddupMAoKjhkxhyiTc7JVOnCG","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"不考虑不合法的节点，假设局面当前局面是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，后续合法决策有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"m","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个，每个决策对应的新局面是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"t_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IbildNYDxo24LwxtK02cjIBynbj","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样局面","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的操作期望就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"E(s)=\\sum_{i=1}^m\\frac{1}{m}E(t_i)+1\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Cn2udHIBbofO4fxqxB7cUu5ynde","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么当考虑了不合法操作之后，假设有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个不合法操作，因为不合法操作不改变当前局面所以是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NiaYdZWmboBEtzxENTnceTccnfe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"E(s)=\\frac{n}{n+m}E(s)+\\sum_{i=1}^m\\frac{1}{n+m}E(t_i)+\\frac{m}{n+m}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"LvCQdJMeEod2RjxGFaqcAvU6nuh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"移项之后会发现是一样的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IFwjdaOXDoHHl7xt1cVcjld9nSb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以这样做是等价的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"W1Wkd3uF2ofh92xNBmZcHzQzn3e","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么这样考虑在一个排列里面为什么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这个数会带来贡献。当且仅当","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"这个数所在的连通块的大小超过","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。假设这个连通块大小为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"；那么之所以出现了这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"大小的连通块，一定是前面删去了若干个和这个连通块相连的若干点设为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。所以一个大小为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的连通块，缩点之后如果度数为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，这个连通块的在排列中出现的概率是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{d!s!}{(d+s)!}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，因为先要出现","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"d","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个被删的点在前面，然后后面再出现","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个本连通块里的点，所以对期望的贡献也是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{d!s!}{(d+s)!}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。因此只要统计这个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"(s,d)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"类型的连通块的数量就行。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"OaW8duNVxoHfIPx8QKncyAmznXg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这就转化到树上DP了。树上背包做转移就行。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"GInndbHS2o0RZlxhgZFcjwkXnVc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这里还涉及到一个树上背包按子树","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"size","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"做背包容量的复杂度计算。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SuJfdTwTEo2KeZx9uk0cr3s9nMb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设树上背包，节点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"u","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，考虑","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的背包方程","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f[u][i][s]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，枚举子树","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的容量","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"t","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"做转移的时候，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"f[u][i][s]=merge(f[u][i-1][s-t],dp[v][t])","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。这里面首先要枚举一个","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"和","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"t","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，看起来是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(n^3)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的复杂度。但实际上","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"s","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"枚举大小如果按点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"u","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"已知的","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"size","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"实时更新，复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(n^2)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"UqVGdgw8XoYNkuxmFAdcwrxCngR","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"大概是这样写","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"CpN6dhQKPowgXXxRpMgcK1SAnZb","block_type":14,"code":{"elements":[{"text_run":{"content":"size[u] = 1;\nfor (int i = 1; i <= adj[u].size(); ++i)\n{\n    int v = adj[u][i-1];\n    for (int s = 1; s <= size[u]; ++s)\n        for (int t = 1; t <= size[v];++t)\n            f[u][i][s+t] = merge(f[u][i-1][s],dp[v][t]);\n    size[u]+=size[v];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"G8FDdhApZodtyTxFMCzc4NeOnEg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"至于原因。可以这样想象。每次子树","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"合并的时候，是向前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个子树里面所有节点合并，等价于把子树","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"v","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"里面的节点和前","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i-1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个子树的里面的节点配对做节点对，每个节点向dfs序在自己前面的节点配对，最终能配出","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(n^2)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点对，因此总复杂度是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(n^2)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false,"indentation_level":"NoIndent"}}},{"block_id":"IZCRdG8oCo2WAnx1e2mcHjsmnqb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么这样整个复杂度就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"O(N^4)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，完全可以通过，甚至跑的相当快。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"NHbIdVANWoPhD0xVR6hcPXP5nJc","block_type":14,"code":{"elements":[{"text_run":{"content":"\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, k;\n    read(n, k);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector adj(n + 1, std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":">{});\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i < n; ++i)\n    {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, v;\n        read(u, v);\n        adj[u].push_back(v), adj[v].push_back(u);\n    }\n\n    std::vector dp(n + 1, std::vector(n + 1, std::vector<modint>(n + 1)));\n    std::vector size(n + 1, 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" dfs = [&](","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"auto","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" &&self, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" u, ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" fa) -> ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"void","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"\n    {\n        if (fa != 0)\n            adj[u].erase(std::find(adj[u].begin(), adj[u].end(), fa));\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v : adj[u])\n            self(self, v, u);\n\n        std::vector f(adj[u].size() + 1, std::vector(n + 1, std::vector<modint>(n + 1)));\n        f[0][1][0] = 1;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= adj[u].size(); ++i)\n        {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" v = adj[u][i - 1];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 1; s <= size[u]; ++s)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" d = 1; d <= size[u]; ++d)\n                    f[i][s][d] = f[i - 1][s][d - 1];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 1; s <= size[u]; ++s)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" t = 1; t <= size[v]; ++t)\n                {\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" d = 0; d <= size[u]; ++d)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"                        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" c = 0; c <= size[v]; ++c)\n                            f[i][s + t][d + c] += f[i - 1][s][d] * dp[v][t][c];\n                }\n            size[u] += size[v];\n        }\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = 1; s <= size[u]; ++s)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" d = 0; d <= size[u]; ++d)\n                dp[u][s][d] += f[adj[u].size()][s][d];\n\n        // for (int s = 1; s <= size[u]; ++s)\n        //     for (int d = 0; d <= size[u]; ++d)\n        //     {\n        //         printf(\"dp[%d][%d][%d] = %d\\n\", u, s, d, dp[u][s][d]);\n        //     }\n    };\n\n    dfs(dfs, 1, 0);\n    Combinatorics<modint> combinatorics(n);\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"        for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" s = k + 1; s <= size[i]; ++s)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"            for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" d = 0; d <= size[i]; ++d)\n            {\n                if (dp[i][s][d] != 0)\n                    ans += dp[i][s][d] * combinatorics.fac[s] * combinatorics.fac[d + (i != 1)] * combinatorics.invfac[s + d + (i != 1)];\n            }\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"WWGFdtMcroIdxIx7YZ8cicVSnGh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结：新技巧get！按局面算期望，生成操作排列，这样把整体的概率计算转移到了局部上，进行分析之后再DP。适合经过几轮操作之后，有的操作合法有的操作不合法的期望计算。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QmWidbW3ioRKgCxVekQc2hkin5c","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC150D.Removing Gacha","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"F9Q5dRQCvoC6unxYMiRcEOjHnLc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有一棵","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点的树，树上节点一开始是白色。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VAgjdzw9Qomid1xBEIOciL8mnsg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"如果一个节点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"到1的路径上全是黑色的点，那么这个点是好点；否则是坏点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"IpL8dOiaLovav0xjiIjcngJNnUd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"现在每次随机地从坏点中选一个点来染成黑色。问把整棵树都染黑的期望数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Q4nCd29sYouKUIxHwadcKh0YnXf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N\\leq2\\times10^5","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EiutdWeuSoQ3G3xBw7Lcayynneb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"PFOzdXDuboSehyxn460cTynGnLh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"相比于上面那道题，这道题相当于取完球之后放回，操作序列是无穷长度的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"P8mYdjTGaoedUTxooANchGWhn8d","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"同样考虑一个操作序列，首先点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"产生贡献当且仅当","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"1->i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的路径上所有点没出现全。这样在这个序列里我们只关心这条路径。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VRSydNy6FozPLYxHyojc7KhpnSh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的深度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dep_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"QizwdhZh5oddMGxYcBQcoY8bnue","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么相当于有放回地取","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dep_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个球，直到所有球都取了一遍，选中","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的期望次数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"X2NFdnGT0ok2POxyrHmcOPDwnWe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"可以写出一个DP。一般期望DP是倒推的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"SCnodoaOJo7jA4x8CxYcMaTynAe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"假设有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个球，设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[x]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示已经抽取了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个球，还需要的操作次数期望。显然","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[n]=0\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"MXdvdgbn5oWrbQxpDjTcKV19ntc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这样就有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[x]=\\frac{x}{n}dp[x]+\\frac{n-x}{n}dp[x+1]+1\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。前者表示取到了一个已经取过的球，局面不变，后者表示取到没取过的球局面改变，每次操作带来1的贡献。最终要的就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[0]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Vg68d0sBQoA0h1xQwhBcpyxOnXf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"然而这里我们想要的是取到了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"号球的次数期望值。做一些修改","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"ZONOdwYC4oV77DxaQ9rcLCLZncc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"dp[x]=\\frac{x}{n}dp[x]+\\frac{n-x}{n}dp[x+1]+\\frac{1}{n}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{1}{n}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的概率产生1的操作次数贡献。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AEQUdytM4oeb1uxQs0AcXW0jnXb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"推一下发现就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[x]=dp[x+1]+\\frac{1}{n-x}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"RbYBdXGvmo9DgMxwoNgce6BsnIe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[0]=\\sum_{x=1}^{n}\\frac{1}{x}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Evz6dCj1doOz6mxtloWcOFcznMy","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"所以点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的操作期望就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{x=1}^{dep_i}\\frac{1}{x}\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。求一个和就行了。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"REYtdgZtvoNvNlxxCEyclwyVnvg","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n;\n    read(n);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> p(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 2; i <= n; ++i)\n        read(p[i]);\n    Combinatorics<modint> combinatorics(n);\n    std::vector<modint> sum(n + 1);\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        sum[i] = sum[i - 1] + combinatorics.inv[i];\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    std::vector<","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":"> dep(n + 1);\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n    {\n        dep[i] = dep[p[i]] + 1;\n        ans += sum[dep[i]];\n    }\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"Agn9dQftAor2e4xJzajccvuvnXf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结：类似题目好像CF也有一道。那个题是这样的：每次找一个白点染色，把整棵子树染黑。求操作次数期望。考虑生成一个操作序列","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P_i\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"提供价值当且仅当","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"P_i\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的祖先们都在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"后面，概率为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{1}{dep_i}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DFRbdAPAXoWXb5xKLxmcRRdVndw","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"而这道题首先是有放回地取数，操作序列是无穷的。其次我们同样只需要考虑点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的路径，因为只有这样才对点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的答案造成影响。通过一个简单的期望DP推出公式。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Yqbvdo6Krox844xXWADcTVErnUc","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"期望DP一般都是逆推，因为终止局面的期望值是最好计算的。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"XX1ZdATTYoZAstxO8PhcXLJInEe","block_type":3,"heading1":{"elements":[{"text_run":{"content":"ARC185D.Random Walk on Tree","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"NTSOdZTJ9oViPuxv5jfc0CIZnch","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N*M+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个节点，下标从0开始。点","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"连接到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"max(i-N,0)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VAmtdIo4oouumfx0rgFcYFFLnah","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"现在从点0出发，问第一次走到所有点的期望。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"DCXmd0wuOopoQFx8TEsc2uhInxh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"equation":{"content":"N,M \\leq 200000","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"L1v1dUNEGoZnaXxi5RucN6OJnCf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"Ow2Md6Hxood5wvxQhYUctwcMnCb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"把图画出来就是一个0点下面挂了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的串。显然每一个串需要走到第","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个数才能走完所有点。那么走完所有点等价于走完了所有串的末尾，且对于位于0点所处的局面，只有走到一个串的末尾才能改变，因此我们只关注目前访问的串末尾的数量","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"C5ESdzBmsonkFjxHD1GcDd16n8g","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i]","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示访问了","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"个不相同的末尾，目前在0点仍需要访问的串末尾数，有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[N]=0\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"AFSKdeAHpooSMnxf4zqcw4fInqg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[i]=\\frac{N-i}{N}dp[i+1]+\\frac{i}{N}dp[i]+1\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WfOEdvHCao8OTwxbPSfcCEYhnBb","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"在访问一个末尾的时候，局面是独立且相同的，考虑一段操作序列，只在最后出现访问到末尾并走回0。那么前面的所有操作，这些不影响局面的无效操作都可以看做是跟最后那段访问到末尾是同一个串上的操作——因为前面的无效操作所属的串是无关紧要的，于是访问到一个串的末尾的操作期望次数等价于在独立的一个串上走到末尾的操作期望。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"X0QkdcpPwoY6QAxX3wMcpYCYnse","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"这可以看做是一个简单的路径图上的随机游走问题。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"C8Sqd7e8Io145axjE3dc4sDYnPf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"设","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"E(X_i)","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"表示从","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"第一次走到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"i+1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的期望次数。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"WbCOdQNkBo8k6xxBxApcyP2wnGe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"那么有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"E(X_i)=\\frac{1}{2}+\\frac{1}{2}(1+E(X_{i-1}+E(X_i))=E(X_{i-1})+2\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"E(0)=1","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"KPeedFD8moMlE9xRhCacFRUhnNe","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"于是第一次从0走到","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的期望就是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\sum_{i=0}^{M-1}E(i)\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，答案是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"M^2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":".走过去再回来相当于两次随机游走，因此是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"2M^2","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"I9Qzd4c1Vo6bijxt9Z1cNWiunbh","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"由于最后一次走到末尾就可以停，不需要回到0点，因此总答案是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"dp[0]*2M^2-M^2\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"U4HVd2xoloEqGaxxZ0vce5K7nNA","block_type":14,"code":{"elements":[{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" Main()\n{\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    ","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" n, m;\n    read(n, m);\n    Combinatorics<modint> combinatorics(n);\n    modint ans = 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"    for (","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"int","text_element_style":{"bold":false,"inline_code":false,"italic":true,"strikethrough":false,"underline":false}}},{"text_run":{"content":" i = 1; i <= n; ++i)\n        ans += combinatorics.inv[i];\n    ans *= 2 * n;\n    ans *= 1ll * m * m;\n    ans -= 1ll * m * m;\n\n    printf(\"%d\\n\", ans);\n    return 0;\n","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"language":9,"wrap":false}},"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc"},{"block_id":"AOQnd9dRQoZbioxzQLzcnXNhnJg","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"总结一下：","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"EuR7de7tsoYmF5xauTic4lq1n1b","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"第一个重点在于分清楚图的样子；","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"FZW2d4i1RoEZ1BxSNoMcVRqFnBd","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"第二个重点是，即便是多个串，走到任意一个串的末尾的期望步数等价于只有一个串走到末尾的期望步数。这是因为刨去最后走到末尾的步数序列，前面的操作是无效且不改变局面的，那么这段操作访问的串的编号无关紧要，因为存在","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"N","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"种长度为","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"L","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的无效操作（只换编号那种），每种概率是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"\\frac{1}{N}","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，乘起来是1，等价于只有一种编号。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}},{"block_id":"VDi7dbxoSo3F0Lxf2TKcG0MgnFf","block_type":2,"parent_id":"DdbndCzmAo0UQRxjT4Mc75IhnUc","text":{"elements":[{"text_run":{"content":"第三个重点是随机游走问题，这也是卡了我很久的地方。这部分局面考虑的是一条边的局面，而不是点的局面，图上的随机游走问题考察的局面是边。同样这也是考虑有效操作——走一条","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"x->y","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"的路径，访问的边是","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p_1,p_2,...,p_k","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"，只有","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"equation":{"content":"p_i","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}},{"text_run":{"content":"是有效的，其它操作不改变局面。","text_element_style":{"bold":false,"inline_code":false,"italic":false,"strikethrough":false,"underline":false}}}],"style":{"align":1,"folded":false}}}],"type":"docx"}